<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Apollo-Server</title>
    <link href="/2020/07/06/Apollo-Server/index/"/>
    <url>/2020/07/06/Apollo-Server/index/</url>
    
    <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><h4 id="Apollo-Server-æ˜¯ä»€ä¹ˆ"><a href="#Apollo-Server-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Apollo Server æ˜¯ä»€ä¹ˆ"></a>Apollo Server æ˜¯ä»€ä¹ˆ</h4><p> <a href="http://www.baidu.com" target="_blank" rel="noopener">Apollo Server</a> æ˜¯ä¸€ç§ç¬¦åˆè§„èŒƒçš„å¼€æº GraphQLæœåŠ¡å™¨ï¼Œèƒ½ä¸ä»»ä½•GraphQLå®¢æˆ·ç«¯ï¼ˆåŒ…æ‹¬Apollo Clientï¼‰å…¼å®¹ã€‚å¹¶ä¸”å¯ä»¥ä½¿ç”¨ä»»ä½•æ¥æºæ•°æ®å»æ„å»ºç”Ÿäº§é¢„å‘ç¯å¢ƒã€ç”Ÿæˆ GraphQL API æ–‡æ¡£çš„æœ€ä½³æ–¹æ³•ã€‚</p><p> æ‚¨å¯ä»¥å°†<strong>Apollo Server</strong>ç”¨ä½œï¼š</p><ul><li><p>ç‹¬ç«‹çš„GraphQLæœåŠ¡å™¨ï¼ŒåŒ…æ‹¬åœ¨serverlessç¯å¢ƒä¸­</p></li><li><p>ç°æœ‰åº”ç”¨çš„Node.jsä¸­é—´ä»¶çš„æ‰©å±•ï¼ˆä¾‹å¦‚Expressæˆ–Fastifyï¼‰çš„é™„ä»¶</p></li><li><p>Federated data graphçš„ç½‘å…³</p><p><strong>Apollo Server</strong> æä¾›ï¼š</p></li><li><p>ç®€å•æ˜“ç”¨çš„è®¾ç½®ï¼Œå› æ­¤æ‚¨çš„å®¢æˆ·ç«¯å¼€å‘äººå‘˜å¯ä»¥å¿«é€Ÿå¼€å§‹è·å–æ•°æ®</p></li><li><p>æ¸è¿›å¼é‡‡ç”¨ï¼Œä½¿æ‚¨å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ åŠŸèƒ½</p></li><li><p>å¯ä»¥å…¼å®¹ä»»ä½•æ•°æ®æºã€æ„å»ºå·¥å…·ã€GraphQLå®¢æˆ·ç«¯</p></li><li><p>ç”Ÿäº§å°±ç»ªï¼Œä½¿æ‚¨èƒ½å¤Ÿæ›´å¿«åœ°å‘å¸ƒåŠŸèƒ½</p></li></ul><h3 id="å¼€å§‹ä½¿ç”¨-Apollo-Server"><a href="#å¼€å§‹ä½¿ç”¨-Apollo-Server" class="headerlink" title="å¼€å§‹ä½¿ç”¨ Apollo Server"></a>å¼€å§‹ä½¿ç”¨ Apollo Server</h3><blockquote><p>æœ¬æ•™ç¨‹ä¸»è¦å¼•å¯¼ä½ å®‰è£…å’Œé…ç½®Apollo Serverã€‚å¦‚æœæ‚¨åˆšåˆšå¼€å§‹ä½¿ç”¨GraphQL æˆ–è€… Apolloå¹³å°ï¼Œæˆ‘ä»¬æ¨èæ‚¨å…ˆå®Œæˆ<a href="https://www.apollographql.com/docs/tutorial/introduction" target="_blank" rel="noopener">full-stack-tutorial</a>ã€‚</p></blockquote><p>æœ¬æ•™ç¨‹å¯ä»¥å¸®åŠ©æ‚¨ï¼š</p><ul><li>å¯¹GraphQLåŸç†æœ‰åŸºæœ¬äº†è§£</li><li>å®šä¹‰ä¸€ä¸ªä»£è¡¨æ•°æ®é›†ç»“æ„çš„GraphQL <strong>schema</strong></li><li>è¿è¡ŒApollo Serverå®ä¾‹ï¼Œä½¿æ‚¨å¯ä»¥ä¾ç…§ä½ çš„schemaæ‰§è¡ŒæŸ¥è¯¢</li></ul><p>æœ¬æ•™ç¨‹å‡å®šæ‚¨ç†Ÿæ‚‰å‘½ä»¤è¡Œå’ŒJavaScriptï¼Œå¹¶ä¸”å·²å®‰è£…äº†æœ€æ–°ç‰ˆæœ¬çš„Node.jsï¼ˆ8+ï¼‰ã€‚</p><h4 id="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®"><a href="#ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®"></a>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®</h4><p>1.åœ¨æ‚¨é¦–é€‰çš„å¼€å‘ç›®å½•ä¸­ï¼Œä¸ºæ–°é¡¹ç›®åˆ›å»ºç›®å½•å¹¶ <code>cd</code> è¿›å…¥è¯¥ç›®å½•ï¼š</p><pre><code class="hljs plain">mkdir graphql-server-examplecd graphql-server-example</code></pre><p>2.ä½¿ç”¨<code>npm</code>ï¼ˆæˆ–æ‚¨å–œæ¬¢çš„å¦ä¸€ä¸ªåŒ…ç®¡ç†å™¨ï¼Œä¾‹å¦‚Yarnï¼‰åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„Node.jsé¡¹ç›®ï¼š</p><pre><code class="hljs plain">npm init --yes</code></pre><p>æ‚¨çš„é¡¹ç›®ç›®å½•ç°åœ¨åŒ…å«ä¸€ä¸ª<code>package.json</code>æ–‡ä»¶ã€‚</p><h4 id="ç¬¬äºŒæ­¥ï¼šå®‰è£…ä¾èµ–é¡¹"><a href="#ç¬¬äºŒæ­¥ï¼šå®‰è£…ä¾èµ–é¡¹" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šå®‰è£…ä¾èµ–é¡¹"></a>ç¬¬äºŒæ­¥ï¼šå®‰è£…ä¾èµ–é¡¹</h4><p>è¿è¡ŒApollo Serverçš„åº”ç”¨ç¨‹åºéœ€è¦ä¸¤ä¸ªé¡¶çº§ä¾èµ–é¡¹ï¼š</p><ul><li><a href="https://www.npmjs.com/package/apollo-server" target="_blank" rel="noopener">apollo-server</a> æ˜¯Apollo Serveræœ¬èº«çš„æ ¸å¿ƒåº“ï¼Œå¯å¸®åŠ©æ‚¨å®šä¹‰æ•°æ®çš„å½¢çŠ¶ä»¥åŠå¦‚ä½•è·å–æ•°æ®ã€‚</li><li><a href="https://www.npmjs.com/package/graphql" target="_blank" rel="noopener">graphql</a> æ˜¯ç”¨äºæ„å»ºGraphQL Schemaå¹¶å¯¹å…¶æ‰§è¡ŒæŸ¥è¯¢çš„åº“ã€‚</li></ul><p>è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥å®‰è£…è¿™ä¸¤ä¸ªä¾èµ–é¡¹å¹¶å°†å®ƒä»¬ä¿å­˜åœ¨é¡¹ç›®çš„<code>node_modules</code>ç›®å½•ä¸­ï¼š</p><pre><code class="hljs plain">npm install apollo-server graphql</code></pre><p>è¿˜è¦<code>index.js</code>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶ï¼š</p><pre><code class="hljs plain">touch index.js</code></pre><p>ä¸ºç®€å•èµ·è§ï¼Œ<code>index.js</code>å°†åŒ…å«æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„æ‰€æœ‰ä»£ç ã€‚</p><h4 id="ç¬¬ä¸‰æ­¥ï¼šå®šä¹‰æ‚¨çš„GraphQL-Schema"><a href="#ç¬¬ä¸‰æ­¥ï¼šå®šä¹‰æ‚¨çš„GraphQL-Schema" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šå®šä¹‰æ‚¨çš„GraphQL Schema"></a>ç¬¬ä¸‰æ­¥ï¼šå®šä¹‰æ‚¨çš„GraphQL Schema</h4><p>æ¯ä¸ªGraphQLæœåŠ¡å™¨ï¼ˆåŒ…æ‹¬ApolloæœåŠ¡å™¨ï¼‰éƒ½ä½¿ç”¨ä¸€ç§<strong>Schema</strong>æ¥å®šä¹‰å®¢æˆ·ç«¯å¯ä»¥æŸ¥è¯¢çš„æ•°æ®ç»“æ„ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œç”¨äºæŒ‰ä¹¦åå’Œä½œè€…æŸ¥è¯¢ä¹¦ç±é›†åˆã€‚</p><p><code>index.js</code>åœ¨æ‚¨å–œæ¬¢çš„ç¼–è¾‘å™¨ä¸­æ‰“å¼€å¹¶å°†ä»¥ä¸‹å†…å®¹ç²˜è´´åˆ°å…¶ä¸­ï¼š</p><pre><code class="hljs plain">const &#123; ApolloServer, gql &#125; &#x3D; require(&#39;apollo-server&#39;);&#x2F;&#x2F; A schema is a collection of type definitions (hence &quot;typeDefs&quot;)&#x2F;&#x2F; that together define the &quot;shape&quot; of queries that are executed against&#x2F;&#x2F; your data.const typeDefs &#x3D; gql&#96;  # Comments in GraphQL strings (such as this one) start with the hash (#) symbol.  # This &quot;Book&quot; type defines the queryable fields for every book in our data source.  type Book &#123;    title: String    author: String  &#125;  # The &quot;Query&quot; type is special: it lists all of the available queries that  # clients can execute, along with the return type for each. In this  # case, the &quot;books&quot; query returns an array of zero or more Books (defined above).  type Query &#123;    books: [Book]  &#125;&#96;;</code></pre><p>æ­¤ä»£ç æ®µå®šä¹‰äº†ä¸€ä¸ªç®€å•æœ‰æ•ˆçš„GraphQL Schemaã€‚å®¢æˆ·å°†èƒ½å¤Ÿæ‰§è¡Œåä¸ºçš„æŸ¥è¯¢booksï¼Œå¹¶ä¸”æˆ‘ä»¬çš„æœåŠ¡å™¨å°†è¿”å›é›¶ä¸ªæˆ–å¤šä¸ªBooks çš„æ•°ç»„ã€‚</p><h4 id="ç¬¬å››æ­¥ï¼šå®šä¹‰æ‚¨çš„æ•°æ®é›†"><a href="#ç¬¬å››æ­¥ï¼šå®šä¹‰æ‚¨çš„æ•°æ®é›†" class="headerlink" title="ç¬¬å››æ­¥ï¼šå®šä¹‰æ‚¨çš„æ•°æ®é›†"></a>ç¬¬å››æ­¥ï¼šå®šä¹‰æ‚¨çš„æ•°æ®é›†</h4><p>ç°åœ¨æˆ‘ä»¬å·²ç»å®šä¹‰äº†æ•°æ®çš„ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰æ•°æ®æœ¬èº«äº†ã€‚ApolloæœåŠ¡å™¨å¯ä»¥ä»æ‚¨è¿æ¥åˆ°çš„ä»»ä½•æºï¼ˆåŒ…æ‹¬æ•°æ®åº“ï¼ŒREST APIï¼Œé™æ€å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œç”šè‡³å¦ä¸€ä¸ªGraphQLæœåŠ¡å™¨ï¼‰ä¸­è·å–æ•°æ®ã€‚å‡ºäºæœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œæˆ‘ä»¬å°†å¯¹ä¸€äº›ç¤ºä¾‹æ•°æ®è¿›è¡Œç¡¬ç¼–ç ã€‚</p><p>å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°çš„åº•éƒ¨<code>index.js</code>ï¼š</p><pre><code class="hljs plain">const books &#x3D; [  &#123;    title: &#39;Harry Potter and the Chamber of Secrets&#39;,    author: &#39;J.K. Rowling&#39;,  &#125;,  &#123;    title: &#39;Jurassic Park&#39;,    author: &#39;Michael Crichton&#39;,  &#125;,];</code></pre><p>æ­¤ä»£ç æ®µå®šä¹‰äº†å®¢æˆ·ç«¯å¯ä»¥æŸ¥è¯¢çš„ç®€å•æ•°æ®é›†ã€‚æ³¨æ„ï¼Œæ•°ç»„ä¸­çš„ä¸¤ä¸ªå¯¹è±¡å‡ä¸Bookæˆ‘ä»¬åœ¨æ¶æ„ä¸­å®šä¹‰çš„ç±»å‹çš„ç»“æ„åŒ¹é…ã€‚</p><h4 id="ç¬¬äº”æ­¥ï¼šå®šä¹‰è§£æå™¨"><a href="#ç¬¬äº”æ­¥ï¼šå®šä¹‰è§£æå™¨" class="headerlink" title="ç¬¬äº”æ­¥ï¼šå®šä¹‰è§£æå™¨"></a>ç¬¬äº”æ­¥ï¼šå®šä¹‰è§£æå™¨</h4><p>æˆ‘ä»¬å·²ç»å®šä¹‰äº†æ•°æ®é›†ï¼Œä½†æ˜¯Apollo Serverä¸çŸ¥é“åœ¨æ‰§è¡ŒæŸ¥è¯¢æ—¶åº”è¯¥å¦‚ä½•ä½¿ç”¨è¯¥æ•°æ®é›†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª resolverã€‚</p><p>è®©è§£æå™¨å‘Šè¯‰Apollo Server å¦‚ä½•è·å–ä¸ç‰¹å®šç±»å‹å…³è”çš„æ•°æ®ã€‚å› ä¸ºæˆ‘ä»¬çš„Bookæ•°ç»„æ˜¯ç¡¬ç¼–ç çš„ï¼Œæ‰€ä»¥ç›¸åº”çš„è§£æå™¨å¾ˆç®€å•ã€‚</p><p>å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°çš„åº•éƒ¨<code>index.js</code>ï¼š</p><pre><code class="hljs plain">&#x2F;&#x2F; Resolvers define the technique for fetching the types defined in the&#x2F;&#x2F; schema. This resolver retrieves books from the &quot;books&quot; array above.const resolvers &#x3D; &#123;  Query: &#123;    books: () &#x3D;&gt; books,  &#125;,&#125;;</code></pre><h4 id="ç¬¬å…­æ­¥ï¼šåˆ›å»ºApolloServerå®ä¾‹"><a href="#ç¬¬å…­æ­¥ï¼šåˆ›å»ºApolloServerå®ä¾‹" class="headerlink" title="ç¬¬å…­æ­¥ï¼šåˆ›å»ºApolloServerå®ä¾‹"></a>ç¬¬å…­æ­¥ï¼šåˆ›å»ºApolloServerå®ä¾‹</h4><p>æˆ‘ä»¬å·²ç»å®šä¹‰äº†æ¶æ„ï¼Œæ•°æ®é›†å’Œè§£æå™¨ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨åˆå§‹åŒ–æ—¶å‘Apollo Serveræä¾›æ­¤ä¿¡æ¯å³å¯ã€‚</p><p>å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°çš„åº•éƒ¨index.jsï¼š</p><pre><code class="hljs plain">&#x2F;&#x2F; The ApolloServer constructor requires two parameters: your schema&#x2F;&#x2F; definition and your set of resolvers.const server &#x3D; new ApolloServer(&#123; typeDefs, resolvers &#125;);&#x2F;&#x2F; The &#96;listen&#96; method launches a web server.server.listen().then((&#123; url &#125;) &#x3D;&gt; &#123;  console.log(&#96;ğŸš€  Server ready at $&#123;url&#125;&#96;);&#125;);</code></pre><h4 id="ç¬¬ä¸ƒæ­¥ï¼šå¯åŠ¨æœåŠ¡å™¨"><a href="#ç¬¬ä¸ƒæ­¥ï¼šå¯åŠ¨æœåŠ¡å™¨" class="headerlink" title="ç¬¬ä¸ƒæ­¥ï¼šå¯åŠ¨æœåŠ¡å™¨"></a>ç¬¬ä¸ƒæ­¥ï¼šå¯åŠ¨æœåŠ¡å™¨</h4><p>æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½å¯åŠ¨æœåŠ¡å™¨ï¼ä»é¡¹ç›®çš„æ ¹ç›®å½•è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><pre><code class="hljs plain">node index.js</code></pre><p>æ‚¨åº”è¯¥çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š</p><pre>ğŸš€ Server ready at http://localhost:4000/</pre><h4 id="ç¬¬å…«æ­¥ï¼šæ‰§è¡Œç¬¬ä¸€ä¸ªæŸ¥è¯¢"><a href="#ç¬¬å…«æ­¥ï¼šæ‰§è¡Œç¬¬ä¸€ä¸ªæŸ¥è¯¢" class="headerlink" title="ç¬¬å…«æ­¥ï¼šæ‰§è¡Œç¬¬ä¸€ä¸ªæŸ¥è¯¢"></a>ç¬¬å…«æ­¥ï¼šæ‰§è¡Œç¬¬ä¸€ä¸ªæŸ¥è¯¢</h4><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡ŒGraphQLæŸ¥è¯¢ã€‚è¦æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸ºGraphQL Playgroundçš„å·¥å…·ã€‚</p><div class="note note-info">            <p>æ³¨æ„ï¼šå¦‚æœå°†æœåŠ¡å™¨éƒ¨ç½²åˆ°NODE_ENVè®¾ç½®ä¸ºçš„ç¯å¢ƒï¼Œåˆ™productioné»˜è®¤æƒ…å†µä¸‹å°†ç¦ç”¨GraphQL Playgroundå’Œè‡ªçœåŠŸèƒ½ã€‚è¦å¯ç”¨å®ƒä»¬ï¼Œæ‚¨éœ€è¦æ˜¾å¼è®¾ç½®ï¼Œplayground: trueå¹¶ introspection: trueåœ¨çš„Constructor é€‰é¡¹ApolloServerå†…ã€‚</p>          </div><p>åœ¨æœåŠ¡å™¨ä»åœ¨è¿è¡Œçš„æƒ…å†µä¸‹ï¼Œ<a href="http://localhost:4000åœ¨æµè§ˆå™¨ä¸­è®¿é—®ä»¥æ‰“å¼€GraphQL">http://localhost:4000åœ¨æµè§ˆå™¨ä¸­è®¿é—®ä»¥æ‰“å¼€GraphQL</a> Playgroundã€‚ï¼ˆåœ¨å¼€å‘ä¸­è¿è¡ŒGraphQL Playgroundæ—¶ï¼ŒApollo Serverä¼šè‡ªåŠ¨æ‰˜ç®¡å®ƒã€‚</p><p>GraphQL Playground UIåŒ…æ‹¬</p><ul><li>ç”¨äºç¼–å†™æŸ¥è¯¢çš„æ–‡æœ¬åŒºåŸŸï¼ˆå·¦ä¾§ï¼‰</li><li>ç”¨äºæ‰§è¡ŒæŸ¥è¯¢çš„â€œæ’­æ”¾â€æŒ‰é’®ï¼ˆä¸­é—´çš„ä¸‰è§’å½¢æŒ‰é’®ï¼‰</li><li>ç”¨äºæŸ¥çœ‹æŸ¥è¯¢ç»“æœçš„æ–‡æœ¬åŒºåŸŸï¼ˆå³ä¾§ï¼‰</li><li>æŸ¥çœ‹æ¶æ„æ£€æŸ¥å’Œç”Ÿæˆçš„æ–‡æ¡£çš„è§†å›¾ï¼ˆé€šè¿‡å³ä¾§çš„é€‰é¡¹å¡ï¼‰</li></ul><p>æˆ‘ä»¬çš„æœåŠ¡å™¨æ”¯æŒä¸€ä¸ªåä¸ºçš„æŸ¥è¯¢<code>books</code>ã€‚è®©æˆ‘ä»¬æ‰§è¡Œå®ƒï¼</p><p>è¿™æ˜¯ç”¨äºæ‰§è¡ŒæŸ¥è¯¢çš„GraphQL æŸ¥è¯¢å­—ç¬¦ä¸²<code>books</code>ã€‚</p><pre>{  books {    title    author  }}</pre><p>å°†æ­¤å­—ç¬¦ä¸²ç²˜è´´åˆ°å·¦ä¾§æ–‡æœ¬åŒºåŸŸï¼Œç„¶åå•å‡»â€œæ’­æ”¾â€æŒ‰é’®ã€‚ç»“æœï¼ˆæ¥è‡ªæˆ‘ä»¬çš„ç¡¬ç¼–ç æ•°æ®é›†ï¼‰æ˜¾ç¤ºåœ¨å³ä¾§ï¼š</p><p>GraphQLçš„æœ€é‡è¦æ¦‚å¿µä¹‹ä¸€æ˜¯æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä»…æŸ¥è¯¢ æ‰€éœ€çš„å­—æ®µã€‚<code>author</code>ä»æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­åˆ é™¤å¹¶å†æ¬¡æ‰§è¡Œã€‚å“åº”æ›´æ–°ä¸ºä»…åŒ…æ‹¬<code>title</code>æ¯æœ¬ä¹¦çš„å­—æ®µï¼</p><h3 id="å®šä¹‰ä¸€ä¸ªSchema"><a href="#å®šä¹‰ä¸€ä¸ªSchema" class="headerlink" title="å®šä¹‰ä¸€ä¸ªSchema"></a>å®šä¹‰ä¸€ä¸ªSchema</h3><h4 id="schemaåŸºç¡€"><a href="#schemaåŸºç¡€" class="headerlink" title="schemaåŸºç¡€"></a>schemaåŸºç¡€</h4><p>GraphQLæœåŠ¡å™¨ä½¿ç”¨<strong>Schema</strong>æè¿°æ•°æ®å›¾çš„å½¢çŠ¶ã€‚Schemaç”¨æ¥æºäºåç«¯çš„æ•°æ®å­—æ®µæ¥å®šä¹‰ä¸åŒå±‚çº§ç±»å‹å±‚æ¬¡ï¼Œschemaè¿˜ç²¾ç¡®æŒ‡å®šäº†èƒ½é’ˆå¯¹æ‚¨çš„æ•°æ®å›¾ã€å¯ç”¨äºå®¢æˆ·ç«¯æ‰§è¡Œçš„queryå’Œmutationã€‚<br>æœ¬æ–‡æ—¨åœ¨ä»‹ç»schemaçš„åŸºæœ¬æ„æˆä»¥åŠå¦‚ä½•ä¸ºæ‚¨çš„GraphQLæœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªSchemaã€‚</p><h5 id="schemaå®šä¹‰è¯­è¨€"><a href="#schemaå®šä¹‰è¯­è¨€" class="headerlink" title="schemaå®šä¹‰è¯­è¨€"></a>schemaå®šä¹‰è¯­è¨€</h5><p>GraphQLè§„èŒƒåŒ…å«ä¸€ç§äººç±»å¯è¯»çš„æ¶æ„å®šä¹‰è¯­è¨€ï¼ˆæˆ–SDLï¼‰ï¼Œå¯ç”¨äºå®šä¹‰Schemaå¹¶å°†å…¶å­˜å‚¨ä¸ºå­—ç¬¦ä¸²</p><p>æˆ‘ä»¬æ¥å®šä¹‰ä¸¤ä¸ªå¯¹è±¡ç±»å‹ï¼š<code>Author</code> å’Œ <code>Book</code></p><pre>type Book {  title: String  author: Author}type Author {  name: String  books: [Book]}</pre><p>Schema å®šä¹‰äº†ç±»å‹çš„é›†åˆå’Œç±»å‹çš„å…³ç³»ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ¯ä¸€ä¸ª<code>Book</code>æœ‰ä¸€ä¸ª<code>author</code>ï¼Œæ¯ä¸€ä¸ª<code>Author</code>æœ‰<code>books</code>çš„åˆ—è¡¨ã€‚é€šè¿‡åœ¨æ•´åˆçš„Schemaä¸­å®šä¹‰è¿™äº›ç±»å‹çš„å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿æ¯ä¸€ä¸ªå®¢æˆ·ç«¯å¼€å‘è€…å¯ä»¥å‡†ç¡®æŸ¥çœ‹å¯ç”¨æ•°æ®ï¼Œ<br>å¹¶ä¸”é€šè¿‡å•ä¸ªä¼˜åŒ–æŸ¥è¯¢è¯·æ±‚è¯¥æ•°æ®çš„ç‰¹å®šå­é›†</p><p>æ³¨æ„Schemaå¹¶ä¸å…³æ³¨æ•°æ®çš„æ¥æºæˆ–è€…å¦‚ä½•å­˜å‚¨ã€‚å®ƒå®Œå…¨ä¸å®ç°æ— å…³ã€‚</p><h5 id="æ”¯æŒçš„ç±»å‹"><a href="#æ”¯æŒçš„ç±»å‹" class="headerlink" title="æ”¯æŒçš„ç±»å‹"></a>æ”¯æŒçš„ç±»å‹</h5><ul><li>æ ‡é‡ç±»å‹</li><li>å¯¹è±¡ç±»å‹</li><li>Query ç±»å‹</li><li>Mutation ç±»å‹</li><li>è¾“å…¥ç±»å‹<br>ä¸‹é¢åˆ†åˆ«è¯¦ç»†ä»‹ç»è¿™äº›å†…å®¹ã€‚</li></ul><h6 id="æ ‡é‡ç±»å‹"><a href="#æ ‡é‡ç±»å‹" class="headerlink" title="æ ‡é‡ç±»å‹"></a>æ ‡é‡ç±»å‹</h6><p>æ ‡é‡ç±»å‹ç±»ä¼¼äºç¼–ç¨‹è¯­è¨€ä¸­çš„åŸºæœ¬ç±»å‹ã€‚ä»–ä»¬æ€»æ˜¯è§£æå…·ä½“çš„æ•°æ®ã€‚</p><p>GraphQLçš„é»˜è®¤æ ‡é‡ç±»å‹ä¸ºï¼š</p><ul><li><code>Int</code>ï¼šæœ‰ç¬¦å·çš„32ä½æ•´æ•°</li><li><code>Float</code>ï¼šå¸¦ç¬¦å·çš„åŒç²¾åº¦æµ®ç‚¹å€¼</li><li><code>String</code>ï¼šUTF-8å­—ç¬¦åºåˆ—</li><li><code>Boolean</code>ï¼štrueæˆ–false</li><li><code>IDï¼ˆåºåˆ—åŒ–ä¸ºStringï¼‰</code>ï¼šå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œé€šå¸¸ç”¨äºé‡æ–°è·å–å¯¹è±¡æˆ–ç”¨ä½œç¼“å­˜çš„é”®ã€‚å°½ç®¡å°†å…¶åºåˆ—åŒ–ä¸ºStringï¼Œä½†<code>ID</code>å¹¶ä¸æ—¨åœ¨ä½¿å…¶æ˜“äºç†è§£ã€‚</li></ul><p>è¿™äº›åŸå§‹ç±»å‹æ¶µç›–äº†å¤§å¤šæ•°ç”¨ä¾‹ã€‚å¯¹äºæ›´ç‰¹å®šçš„ç”¨ä¾‹ï¼Œæ‚¨å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰æ ‡é‡ç±»å‹ã€‚</p><h6 id="å¯¹è±¡ç±»å‹"><a href="#å¯¹è±¡ç±»å‹" class="headerlink" title="å¯¹è±¡ç±»å‹"></a>å¯¹è±¡ç±»å‹</h6><p>åœ¨GraphQLæ¨¡å¼ä¸­å®šä¹‰çš„å¤§å¤šæ•°ç±»å‹éƒ½æ˜¯å¯¹è±¡ç±»å‹ã€‚å¯¹è±¡ç±»å‹åŒ…å«å­—æ®µçš„é›†åˆï¼Œæ¯ä¸ªå­—æ®µå¯ä»¥æ˜¯æ ‡é‡ç±»å‹æˆ–å…¶ä»–å¯¹è±¡ç±»å‹ã€‚</p><p>ä¸¤ç§å¯¹è±¡ç±»å‹å¯ä»¥å½¼æ­¤åŒ…å«ä¸ºå­—æ®µï¼Œå°±åƒå‰é¢çš„ç¤ºä¾‹Schemaä¸­é‚£æ ·ï¼š</p><pre>type Book {  title: String  author: Author}type Author {  name: String  books: [Book]}</pre><h6 id="Query-ç±»å‹"><a href="#Query-ç±»å‹" class="headerlink" title="Query ç±»å‹"></a>Query ç±»å‹</h6><p>Queryç±»å‹å®šä¹‰æ ¹æ®æ‚¨çš„æ•°æ®å›¾æ‰§è¡ŒæŸ¥è¯¢çš„å…¥å£ç‚¹ã€‚å®ƒç±»ä¼¼äºå¯¹è±¡ç±»å‹ï¼Œä½†å…¶åç§°å§‹ç»ˆä¸ºQueryã€‚</p><p>Queryç±»å‹çš„æ¯ä¸ªå­—æ®µå®šä¹‰ä¸åŒå…¥å£ç‚¹çš„åç§°å’Œè¿”å›ç±»å‹ã€‚Queryæˆ‘ä»¬çš„Schemaç±»å‹å¯èƒ½ç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼š</p><pre>type Query {  books: [Book]  authors: [Author]}</pre><p>è¿™ä¸ªæŸ¥è¯¢ç±»å‹å®šä¹‰äº†ä¸¤ä¸ªå­—æ®µï¼š<code>books</code> å’Œ <code>authors</code>ã€‚æ¯ä¸ªå­—æ®µéƒ½è¿”å›ä¸€ä¸ªåˆ—è¡¨<br>åŸºäºRestFul APIï¼Œbooks å’Œ authors å¾ˆå¯èƒ½ä»ä¸åŒçš„ç«¯ç‚¹è¿”å›ï¼ˆegï¼š <code>/api/books</code> å’Œ <code>/api/authors</code>ã€‚è€ŒGraphQLçš„çµæ´»æ€§èƒ½ä¿è¯é€šè¿‡ä¸€ä¸ªè¯·æ±‚è¿”å›è¿™ä¸¤ä¸ªæ•°æ®ã€‚</p><p><strong>æ„é€ ä¸€ä¸ªquery</strong><br>å½“ä½ å¼€å§‹æ ¹æ®ä½ çš„æ•°æ®å›¾æ¥åˆ›å»ºæŸ¥è¯¢æ—¶ï¼Œè¿™äº›æŸ¥è¯¢å¿…é¡»ä¸ä½ åœ¨Schemaä¸­å®šä¹‰å¥½çš„ç»“æ„ç›¸åŒ¹é…ã€‚</p><p>åŸºäºæˆ‘ä»¬ä¾‹å­ä¸­Schemaï¼Œå®¢æˆ·ç«¯æ‰§è¡Œä¸‹é¢çš„æŸ¥è¯¢æ“ä½œï¼Œå°†ä¼šè¿”å›æ‰€æœ‰çš„bookså’Œauthor çš„åˆ—è¡¨</p><pre>query GetBooksAndAuthors {  books {    title  }  authors {    name  }}</pre><p>æœåŠ¡ç«¯ä¼šæ ¹æ®æŸ¥è¯¢ç»“æ„ï¼Œå°†æŸ¥è¯¢åˆ°çš„ç»“æœåšå¦‚ä¸‹è¿”å›</p><pre>{  "data": {    "books": [      {        "title": "Jurassic Park"      },      ...    ],    "authors": [      {        "name": "Michael Crichton"      },      ...    ]  }}</pre><p>å°½ç®¡åœ¨æŸäº›æƒ…å†µä¸‹è·å–è¿™ä¸¤ä¸ªå•ç‹¬çš„åˆ—è¡¨å¯èƒ½å¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯å®¢æˆ·å¯èƒ½æ›´å–œæ¬¢è·å–ä¸€ä¸ªå›¾ä¹¦åˆ—è¡¨ï¼Œå…¶ä¸­æ¯æœ¬ä¹¦çš„ä½œè€…éƒ½åŒ…å«åœ¨ç»“æœä¸­ã€‚<br>å› ä¸ºæˆ‘ä»¬çš„Schemaçš„Bookç±»å‹å…·æœ‰typeçš„authorå­—æ®µAuthorï¼Œæ‰€ä»¥å®¢æˆ·ç«¯å¯ä»¥æ”¹ä¸ºè¿™æ ·æ„é€ å…¶æŸ¥è¯¢ï¼š</p><pre>query GetBooks {  books {    title    author {      name    }  }}</pre><p>å†ä¸€æ¬¡ï¼Œæˆ‘ä»¬çš„æœåŠ¡å™¨å°†å“åº”ä¸æŸ¥è¯¢ç»“æ„åŒ¹é…çš„ç»“æœï¼š</p><pre>{  "data": {    "books": [      {        "title": "Jurassic Park",        "author": {          "name": "Michael Crichton"        }      },      ...    ]  }}</pre><h6 id="Mutation-ç±»å‹"><a href="#Mutation-ç±»å‹" class="headerlink" title="Mutation ç±»å‹"></a>Mutation ç±»å‹</h6><p>Mutationç±»å‹åœ¨ç»“æ„å’Œç›®çš„ä¸Queryç±»å‹ç±»ä¼¼ã€‚Queryç±»å‹å®šä¹‰äº†è¯»æ“ä½œçš„å…¥å£ç‚¹ï¼Œè€ŒMutationç±»å‹å®šä¹‰äº†å†™æ“ä½œçš„å…¥å£ç‚¹ã€‚</p><p>Mutationç±»å‹çš„æ¯ä¸ªå­—æ®µå®šä¹‰ä¸åŒå…¥å£ç‚¹çš„æ ‡å¿—å’Œè¿”å›ç±»å‹ã€‚Mutationæˆ‘ä»¬çš„ç¤ºä¾‹Schemaçš„ç±»å‹å¯èƒ½ç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼š</p><pre>type Mutation {  addBook(title: String, author: String): Book}</pre><p>è¿™ä¸ªmutationç±»å‹å®šä¹‰äº†ä¸€ä¸ªå¯ç”¨çš„mutationï¼Œ<code>addBook</code>ã€‚è¿™ä¸ªmutationæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ˆtitleå’Œauthorï¼‰å¹¶ä¸”è¿”å›ä¸€ä¸ªæ–°çš„<code>Book</code>å¯¹è±¡ã€‚æ­£å¦‚ä½ æ‰€æœŸæœ›çš„ï¼Œè¿™ä¸ª<code>Book</code>å¯¹è±¡éµå¾ªæˆ‘ä»¬åœ¨schemaä¸­å®šä¹‰çš„ç»“æ„ã€‚</p><p><strong>æ„é€ ä¸€ä¸ªmutation</strong><br>å’Œqueryä¸€æ ·ï¼Œmutationsä¹Ÿåº”ä¸æˆ‘ä»¬çš„schema å®šä¹‰çš„ç±»å‹ç›¸åŒ¹é…ã€‚ä¸‹é¢çš„mutation åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„<code>Book</code>è€Œä¸”è¯·æ±‚å·²åˆ›å»ºçš„å¯¹è±¡çš„ç‰¹å®šå­—æ®µä½œä¸ºè¿”å›å€¼ã€‚</p><pre>mutation CreateBook {  addBook(title: "Fox in Socks", author: "Dr. Seuss") {    title    author {      name    }  }}</pre><p>æœåŠ¡ç«¯å°†æ ¹æ®æˆ‘ä»¬è®¾è®¡çš„mutationç»“æ„è¿”å›ç»“æœ</p><pre>{  "data": {    "addBook": {      "title": "Fox in Socks",      "author": {        "name": "Dr. Seuss"      }    }  }}</pre><p>ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚å¯èƒ½åŒ…å«å¤šä¸ªéœ€è¦æ‰§è¡Œçš„mutationã€‚ä¸ºäº†é¿å…å‡ºç°ç«æ€ï¼Œmutationsçš„æ‰§è¡Œæ˜¯çº¿æ€§çš„ï¼ˆæ ¹æ®åˆ—å‡ºçš„é¡ºåºï¼‰</p><p>å­¦ä¹ æ›´å¤šå…³äºmutationsçš„è®¾è®¡</p><h6 id="è¾“å…¥ç±»å‹"><a href="#è¾“å…¥ç±»å‹" class="headerlink" title="è¾“å…¥ç±»å‹"></a>è¾“å…¥ç±»å‹</h6><p>è¾“å…¥ç±»å‹æ˜¯ç‰¹æ®Šçš„å¯¹è±¡ç±»å‹ï¼Œå®ƒå…è®¸ä½ ä¼ é€’ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°è¿›è¡Œqueryå’Œmutationæ“ä½œï¼ˆä¸ä»…æ”¯æŒä¼ æ ‡é‡ç±»å‹ç›¸å¯¹ï¼‰ã€‚è¾“å…¥ç±»å‹å¯ä»¥å¸®åŠ©ä¿æŒæ“ä½œæ ‡è¯†çš„æ•´æ´ï¼Œå°±åƒåœ¨JavaScriptå‡½æ•°ä¸­æ¥å—å•ä¸ª<code>options</code>å¯¹è±¡æ¯”é‡å¤æ·»åŠ å‚æ•°æ›´å¹²å‡€ä¸€æ ·ã€‚</p><p>çœ‹ä¸€ä¸‹è¿™ä¸ªæäº¤åˆ›å»ºblogçš„mutationæ“ä½œï¼š</p><pre>type Mutation {  createPost(title: String, body: String, mediaUrls: [String]): Post}</pre><p>ä¸æ¥æ”¶ä¸‰ä¸ªå‚æ•°ç›¸å¯¹ï¼Œä¸‹é¢è¿™ä¸ªmutationåªæ¥å—ä¸€ä¸ªè¾“å…¥ç±»å‹ï¼ˆåŒ…å«è¿™ä¸‰ä¸ªå‚æ•°ï¼‰ã€‚å¦‚æœæˆ‘ä»¬åœ¨å°†æ¥å†³å®šå¢åŠ ä¸€ä¸ªå‚æ•°ä¼šæ˜¾å¾—æ ¼å¤–çš„æ–¹ä¾¿ï¼Œä¾‹å¦‚ <code>author</code></p><p>å®šä¹‰è¾“å…¥ç±»å‹å’Œå¯¹è±¡ç±»å‹å¾ˆç›¸ä¼¼ï¼Œ å”¯ä¸€ä¸åŒå°±æ˜¯æˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>input</code>å…³é”®å­—</p><pre>type Mutation {  createPost(post: PostAndMediaInput): Post}input PostAndMediaInput {  title: String  body: String  mediaUrls: [String]}</pre><p>è¾“å…¥ç±»å‹ä¸ä»…ä¿ƒè¿›äº†PostAndMediaInputç±»å‹åœ¨æˆ‘ä»¬Schemaä¸­çš„ä¼ é€’ï¼Œè€Œä¸”æä¾›äº†ç»™å­—æ®µå¢åŠ æ³¨é‡Šç©ºé—´ï¼Œè¯¥æè¿°å¯ä»¥è‡ªåŠ¨çš„æš´éœ²ç»™GraphQLå¯ç”¨å·¥å…·ã€‚</p><pre>input PostAndMediaInput {  "A main title for the post"  title: String  "The text body of the post."  body: String  "A list of URLs to render in the post."  mediaUrls: [String]}</pre><p>å½“å¤šä¸ªæ“ä½œéœ€è¦å®Œå…¨ç›¸åŒçš„æ•°æ®é›†åˆæ—¶ï¼Œè¾“å…¥ç±»å‹æœ‰æ—¶ä¼šå¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯æ‚¨åº”è¯¥è°¨æ…åœ°å¤ç”¨å®ƒä»¬ã€‚æ“ä½œæœ€ç»ˆå¯èƒ½ä¼šåœ¨å…¶æ‰€éœ€çš„å‚æ•°ä¹‹é—´äº§ç”Ÿåˆ†æ­§ã€‚</p><p><strong>ä¸è¦å¯¹queryå’Œmutationä½¿ç”¨ç›¸åŒ</strong>çš„è¾“å…¥ç±»å‹ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œmutationæ‰€éœ€çš„å‚æ•°å¯¹äºç›¸åº”çš„queryæ˜¯å¯é€‰çš„ã€‚</p><h5 id="Schemaçš„æ¼”å˜"><a href="#Schemaçš„æ¼”å˜" class="headerlink" title="Schemaçš„æ¼”å˜"></a>Schemaçš„æ¼”å˜</h5><p>éšç€ä½ çš„ç»„ç»‡æˆé•¿ä¸æ¼”å˜ï¼Œä½ çš„æ•°æ®å›¾ä¹Ÿä¼šç›¸åº”çš„æˆé•¿ã€‚æ–°çš„äº§å“å’Œç‰¹æ€§ä¼šå¼•å…¥æ–°çš„Schemaç±»å‹å’Œå­—æ®µã€‚ä¸ºäº†è¿½è¸ªè¿™æ®µæ—¶é—´çš„å˜åŒ–ï¼Œä½ åº”è¯¥ç”¨ç‰ˆæœ¬æ§åˆ¶å»ç»´æŠ¤ä½ çš„å®šä¹‰çš„Schemaã€‚</p><p>å¤§å¤šæ•°çš„Schemaçš„å¢åŠ æ˜¯å®‰å…¨ä¸”å‘åå…¼å®¹çš„ã€‚ä½†æ˜¯ï¼Œå‘ç”Ÿçš„å˜åŒ–äº§ç”Ÿçš„åˆ é™¤å’Œä¿®æ”¹è¡Œä¸ºå¯¹äºä¸€ä¸ªæˆ–æ›´å¤šå·²å­˜åœ¨çš„åº”ç”¨å¯èƒ½æ˜¯ç ´åæ€§çš„æ”¹å˜ã€‚ä¸‹é¢çš„schemaæ”¹å˜ä¼šå…·æœ‰æ½œåœ¨çš„ç ´åæ€§ï¼š</p><ul><li>åˆ é™¤ä¸€ä¸ªç±»å‹æˆ–å­—æ®µ</li><li>é‡å‘½åä¸€ä¸ªç±»å‹æˆ–å­—æ®µ</li><li>å¢åŠ ä¸€ä¸ªå¯ä¸ºç©ºå­—æ®µ</li><li>åˆ é™¤ä¸€ä¸ªå­—æ®µå‚æ•°</li></ul><p>è¯¸å¦‚Apollo Studio[<a href="https://studio.apollographql.com]ä¹‹ç±»çš„å›¾å½¢ç®¡ç†å·¥å…·å¯å¸®åŠ©æ‚¨äº†è§£æ½œåœ¨çš„Schemaæ›´æ”¹æ˜¯å¦ä¼šå½±å“æ‚¨çš„æ­£åœ¨ä½¿ç”¨å®¢æˆ·ç«¯ã€‚Studioè¿˜é€šè¿‡æ“ä½œå®‰å…¨åˆ—è¡¨æä¾›å­—æ®µçº§æ€§èƒ½æŒ‡æ ‡ï¼ŒSchemaå†å²è®°å½•è·Ÿè¸ªå’Œé«˜çº§å®‰å…¨æ€§ã€‚">https://studio.apollographql.com]ä¹‹ç±»çš„å›¾å½¢ç®¡ç†å·¥å…·å¯å¸®åŠ©æ‚¨äº†è§£æ½œåœ¨çš„Schemaæ›´æ”¹æ˜¯å¦ä¼šå½±å“æ‚¨çš„æ­£åœ¨ä½¿ç”¨å®¢æˆ·ç«¯ã€‚Studioè¿˜é€šè¿‡æ“ä½œå®‰å…¨åˆ—è¡¨æä¾›å­—æ®µçº§æ€§èƒ½æŒ‡æ ‡ï¼ŒSchemaå†å²è®°å½•è·Ÿè¸ªå’Œé«˜çº§å®‰å…¨æ€§ã€‚</a></p><h5 id="æ–‡æ¡£å­—ç¬¦ä¸²"><a href="#æ–‡æ¡£å­—ç¬¦ä¸²" class="headerlink" title="æ–‡æ¡£å­—ç¬¦ä¸²"></a>æ–‡æ¡£å­—ç¬¦ä¸²</h5><p>GraphQLçš„Schemaå®šä¹‰è¯­è¨€ï¼ˆSDLï¼‰æ”¯æŒå¯ç”¨markdownçš„æ–‡æ¡£å­—ç¬¦ä¸²ã€‚è¿™äº›å¯å¸®åŠ©æ•°æ®å›¾çš„ä½¿ç”¨è€…å‘ç°å­—æ®µå¹¶å­¦ä¹ å¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚</p><p>ä»¥ä¸‹ä»£ç æ®µæ˜¾ç¤ºäº†å¦‚ä½•åŒæ—¶ä½¿ç”¨å•è¡Œå­—ç¬¦ä¸²æ–‡å­—å’Œå¤šè¡Œå—ï¼š</p><pre>"Description for the type"type MyObjectType {  """  Description for field  Supports **multi-line** description for your [API](http://example.com)!  """  myField: String!  otherField(    "Description for argument"    arg: Int  )}</pre><p>æ–‡æ¡£å®Œå–„çš„schemaå¯ä»¥æå‡å¼€å‘è€…ä½“éªŒï¼Œå› ä¸ºGraphQLå¼€å‘è€…å·¥å…·ï¼ˆä¾‹å¦‚Apollo VS Code extension å’Œ GraphQL Playgroundï¼‰å¯ä»¥æ ¹æ®æˆ‘ä»¬æä¾›çš„æè¿°è‡ªåŠ¨å¡«å†™å­—æ®µåã€‚è€Œä¸” Apollo Studioåœ¨ä½¿ç”¨å…¶æŒ‡æ ‡æŠ¥å‘Šå’Œå®¢æˆ·ç«¯æ„ŸçŸ¥åŠŸèƒ½æ—¶ï¼Œä¼šåœ¨å­—æ®µä½¿ç”¨æƒ…å†µå’Œæ€§èƒ½è¯¦ç»†ä¿¡æ¯çš„æ—è¾¹æ˜¾ç¤ºè¯´æ˜</p><h5 id="å‘½åè§„èŒƒ"><a href="#å‘½åè§„èŒƒ" class="headerlink" title="å‘½åè§„èŒƒ"></a>å‘½åè§„èŒƒ</h5><p>GraphQLè§„èŒƒæ˜¯å¾ˆçµæ´»çš„è€Œä¸”ä¸å¼ºåˆ¶ç‰¹å®šçš„å‘½åè§„èŒƒã€‚ä½†æ˜¯åœ¨ç»„ç»‡ä¸­å»ºç«‹ä¸€ä¸ªçº¦å®šé›†åˆç¡®ä¿æŒç»­é›†æˆæ˜¯å¾ˆæœ‰ç”¨çš„ã€‚æˆ‘ä»¬æ¨èå¦‚ä¸‹ï¼š</p><ul><li>å­—æ®µå ä½¿ç”¨<code>camelCase</code>å‘½åã€‚å¤§éƒ¨åˆ†GraphQLå®¢æˆ·ç«¯éƒ½ä½¿ç”¨ JavaScript, Java, Kotlin, or Swiftï¼Œæˆ‘ä»¬éƒ½æ¨èä½¿ç”¨<code>camelCase</code>å‘½åå˜é‡å</li><li>ç±»å‹å ä½¿ç”¨<code>PascalCase</code>å‘½åã€‚è¿™ä¸ä¸Šè¿°è¯­è¨€ä¸­å®šä¹‰ç±»çš„æ–¹å¼åŒ¹é…</li><li>æšä¸¾å ä½¿ç”¨<code>PascalCase</code></li><li>æšä¸¾å€¼ ä½¿ç”¨<code>ALL_CAPS</code>ï¼Œå› ä¸ºå®ƒä»¬ç±»ä¼¼äºå¸¸é‡</li></ul><p>è¿™äº›çº¦å®šæœ‰åŠ©äºç¡®ä¿å¤§å¤šæ•°å®¢æˆ·ç«¯ä¸éœ€è¦å®šä¹‰é¢å¤–çš„é€»è¾‘å³å¯è½¬æ¢æœåŠ¡å™¨è¿”å›çš„ç»“æœ</p><h5 id="query-é©±åŠ¨çš„Schemaè®¾è®¡"><a href="#query-é©±åŠ¨çš„Schemaè®¾è®¡" class="headerlink" title="query é©±åŠ¨çš„Schemaè®¾è®¡"></a>query é©±åŠ¨çš„Schemaè®¾è®¡</h5><p>å½“GraphQL schemaçš„æ‰§è¡Œæ“ä½œæ˜¯ä¾æ®å®¢æˆ·ç«¯çš„éœ€æ±‚è€Œè®¾è®¡æ—¶ï¼Œå…¶åŠŸèƒ½æœ€ä¸ºå¼ºå¤§ã€‚å°½ç®¡æ‚¨å¯ä»¥æ„é€ ç±»å‹ï¼Œä½¿å®ƒä»¬ä¸åç«¯æ•°æ®å­˜å‚¨çš„ç»“æ„åŒ¹é…ï¼Œä½†æ‚¨duckä¸å¿…è¿™æ ·ï¼å•ä¸ªå¯¹è±¡ç±»å‹çš„å­—æ®µå¯ä»¥è®¸å¤šä¸åŒæ¥æºçš„æ•°æ®æ‰€å¡«å……ã€‚<strong>æ ¹æ®æ•°æ®çš„ä½¿ç”¨æ–¹å¼ï¼ˆè€Œä¸æ˜¯æ•°æ®çš„å­˜å‚¨æ–¹å¼ï¼‰è®¾è®¡Schema</strong>ã€‚</p><p>å¦‚æœæ‚¨çš„æ•°æ®å­˜å‚¨åŒºåŒ…å«å®¢æˆ·ç«¯å°šä¸éœ€è¦çš„å­—æ®µæˆ–å…³ç³»ï¼Œè¯·ä»æ‚¨çš„Schemaä¸­å°†å…¶å¿½ç•¥ã€‚å‘Schemaä¸­æ·»åŠ æ–°å­—æ®µæ¯”åˆ é™¤æŸäº›å®¢æˆ·ç«¯æ­£åœ¨ä½¿ç”¨çš„ç°æœ‰å­—æ®µæ›´åŠ å®¹æ˜“å’Œå®‰å…¨ã€‚</p><p><strong>query é©±åŠ¨çš„Schemaè®¾è®¡ç¤ºä¾‹</strong><br>å‡è®¾æˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªWebåº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åˆ—å‡ºäº†æˆ‘ä»¬åœ°åŒºå†…çš„è¿‘æœŸæ´»åŠ¨ã€‚æˆ‘ä»¬å¸Œæœ›è¯¥åº”ç”¨æ˜¾ç¤ºæ¯ä¸ªäº‹ä»¶çš„åç§°ï¼Œæ—¥æœŸå’Œä½ç½®ï¼Œä»¥åŠå¤©æ°”é¢„æŠ¥ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›Webåº”ç”¨èƒ½å¤Ÿæ‰§è¡Œå…·æœ‰ç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„ç»“æ„çš„æŸ¥è¯¢</p><pre>query EventList {  upcomingEvents {    name    date    location {      name      weather {        temperature        description      }    }  }}</pre><p>å› ä¸ºæˆ‘ä»¬çŸ¥é“è¿™æ˜¯å¯¹æˆ‘ä»¬çš„å®¢æˆ·æœ‰å¸®åŠ©çš„æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾è®¡schemaçš„ç»“æ„ï¼š</p><pre>type Query {  upcomingEvents: [Event]}type Event {  name: String  date: String  location: Location}type Location {  name: String  weather: WeatherInfo}type WeatherInfo {  temperature: Float  description: String}</pre><p>å¦‚ä¸Šæ‰€è¿°ï¼Œå¯ä»¥ä½¿ç”¨æ¥è‡ªä¸åŒæ•°æ®æºï¼ˆæˆ–å¤šä¸ªæ•°æ®æºï¼‰çš„æ•°æ®å¡«å……æ¯ä¸€ä¸ªç±»å‹ä¸­ã€‚ä¾‹å¦‚ï¼Œè¯¥<code>Eventç±»å‹</code>çš„<code>name</code>å’Œ<code>date</code>å­—æ®µå¯èƒ½ä»åç«¯æ•°æ®åº“è·å–``ï¼Œè€Œè¯¥WeatherInfoç±»å‹çš„å¯èƒ½æ¥è‡ªç¬¬ä¸‰æ–¹Weather APIçš„æ•°æ®ã€‚</p><h5 id="è®¾è®¡mutation"><a href="#è®¾è®¡mutation" class="headerlink" title="è®¾è®¡mutation"></a>è®¾è®¡mutation</h5><p>åœ¨GraphQLä¸­ï¼Œå»ºè®®æ¯ä¸ªmutationçš„è¿”å›å€¼éƒ½åŒ…å«è¯¥mutationä¿®æ”¹çš„æ•°æ®ã€‚è¿™ä½¿å®¢æˆ·ç«¯æ— éœ€å‘é€åç»­æŸ¥è¯¢å³å¯è·å–æœ€æ–°çš„æŒä¹…åŒ–æ•°æ®ã€‚</p><p>ä¸€ä¸ªSchemaï¼Œæ”¯æŒæ›´æ–°emailçš„Userä¼šåŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š</p><pre> type Mutation {   # This mutation takes id and email parameters and responds with a User   updateUserEmail(id: ID!, email: String!): User } type User {   id: ID!   name: String!   email: String! }</pre><p>ç„¶åï¼Œå®¢æˆ·ç«¯å¯ä»¥é’ˆå¯¹å…·æœ‰ä»¥ä¸‹ç»“æ„çš„schemaæ‰§è¡Œmutationï¼š</p><pre>mutation updateMyUser {  updateUserEmail(id: 1, email: "jane@example.com"){    id    name    email  }}</pre><p>GraphQLæœåŠ¡å™¨æ‰§è¡Œæ›´æ”¹å¹¶ä¸ºç”¨æˆ·å­˜å‚¨æ–°çš„ç”µå­é‚®ä»¶åœ°å€åï¼Œå®ƒå°†ä½¿ç”¨ä»¥ä¸‹å†…å®¹å“åº”å®¢æˆ·ç«¯ï¼š</p><pre>{  "data": {    "updateUserEmail": {      "id": "1",      "name": "Jane Doe",      "email": "jane@example.com"    }  }}</pre><p>è™½ç„¶å®ƒä¸æ˜¯å¼ºåˆ¶æ€§çš„mutationçš„è¿”å›åŒ…æ‹¬ä¿®æ”¹çš„å¯¹è±¡ï¼Œè¿™æ ·å¤§å¤§æé«˜äº†å®¢æˆ·ç«¯ä»£ç çš„æ•ˆç‡ã€‚ä¸æŸ¥è¯¢ä¸€æ ·ï¼Œç¡®å®šå“ªäº›mutationå¯¹æ‚¨çš„å®¢æˆ·æœ‰ç”¨ï¼Œè¿™æœ‰åŠ©äºå‘ŠçŸ¥æ¶æ„çš„ç»“æ„ã€‚</p><h6 id="æ„å»ºçªå˜ååº”"><a href="#æ„å»ºçªå˜ååº”" class="headerlink" title="æ„å»ºçªå˜ååº”"></a>æ„å»ºçªå˜ååº”</h6><p>å•ä¸ªmutationå¯ä»¥ä¿®æ”¹å¤šç§ç±»å‹ï¼Œæˆ–åŒä¸€ç±»å‹çš„å¤šä¸ªå®ä¾‹ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿâ€œå–œæ¬¢â€åšå®¢æ–‡ç« çš„mutationå¯èƒ½ä¼šå¢åŠ <code>Post</code>çš„<code>likes</code>è®¡æ•°ï¼Œå¹¶æ›´æ–°çš„<code>likedPosts</code>çš„<code>User</code>åˆ—è¡¨ã€‚è¿™ä½¿å¾—mutationè¿”å›çš„ç»“æ„ä¸å¤ªæ˜æ™°ã€‚</p><p>æ­¤å¤–ï¼Œç”±äºmutationä¼šä¿®æ”¹æ•°æ®ï¼Œå› æ­¤æ¯”æŸ¥è¯¢å¼•èµ·é”™è¯¯çš„å¯èƒ½æ€§è¦é«˜å¾—å¤šã€‚mutationç”šè‡³å¯èƒ½å¯¼è‡´éƒ¨åˆ†é”™è¯¯ï¼Œæ¯”å¦‚æˆåŠŸä¿®æ”¹äº†ä¸€æ¡æ•°æ®è€Œæ²¡æœ‰ä¿®æ”¹å¦ä¸€æ¡æ•°æ®ã€‚æ— è®ºé”™è¯¯çš„ç±»å‹å¦‚ä½•ï¼Œä»¥ä¸€è‡´çš„æ–¹å¼å°†é”™è¯¯ä¼ è¾¾å›å®¢æˆ·ç«¯éƒ½æ˜¯å¾ˆé‡è¦çš„ã€‚</p><p>ä¸ºå¸®åŠ©è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œå»ºè®®æ‚¨åœ¨æ¶æ„ä¸­å®šä¹‰ä¸€ä¸ª<code>MutationResponse</code>æ¥å£ï¼Œä»¥åŠç”¨å¯¹è±¡ç±»å‹çš„é›†åˆå®ç°è¯¥æ¥å£ï¼ˆæ¯ä¸ªmutationä¸€ä¸ªï¼‰ã€‚</p><p>ä¸‹é¢æ˜¯ä»€ä¹ˆMutationResponseæ¥å£çš„æ ·å­ï¼š</p><pre>interface MutationResponse {  code: String!  success: Boolean!  message: String!}</pre><p>è¿™æ˜¯ä¸€ä¸ªå®ç°å¯¹è±¡ç±»å‹ï¼š</p><pre>type UpdateUserEmailMutationResponse implements MutationResponse {  code: String!  success: Boolean!  message: String!  user: User}</pre><p>æˆ‘ä»¬çš„updateUserEmailçš„mutationå°†æŒ‡å®šUpdateUserEmailMutationResponseä¸ºè¿”å›ç±»å‹ï¼ˆè€Œä¸æ˜¯Userï¼‰ï¼Œå…¶å“åº”çš„ç»“æ„å¦‚ä¸‹ï¼š</p><pre>{  "data": {    "updateUser": {      "code": "200",      "success": true,      "message": "User email was successfully updated",      "user": {        "id": "1",        "name": "Jane Doe",        "email": "jane@example.com"      }    }  }}</pre><p>è®©æˆ‘ä»¬æŒ‰å­—æ®µç»†åˆ†æ­¤å­—æ®µï¼š<br>codeæ˜¯ä»£è¡¨æ•°æ®ä¼ è¾“çŠ¶æ€çš„å­—ç¬¦ä¸²ã€‚å¯ä»¥å°†å…¶è§†ä¸ºHTTPçŠ¶æ€ä»£ç ã€‚<br>successæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤ºmutationæ˜¯å¦æˆåŠŸã€‚è¿™å…è®¸å®¢æˆ·ç«¯è¿›è¡Œç²—ç•¥æ£€æŸ¥ï¼Œä»¥äº†è§£æ˜¯å¦å­˜åœ¨æ•…éšœã€‚<br>messageæ˜¯æè¿°mutationç»“æœçš„å¯è¯»æ€§å­—ç¬¦ä¸²ã€‚å¯ä»¥åœ¨äº§å“çš„UIä¸­ä½¿ç”¨ã€‚<br>userç”±å®ç°ç±»å‹æ·»åŠ ï¼ŒUpdateUserEmailMutationResponseä»¥å°†æ–°æ›´æ–°çš„ç”¨æˆ·è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p>å¦‚æœmutationä¿®æ”¹å¤šç§ç±»å‹ï¼ˆä¾‹å¦‚æˆ‘ä»¬å‰é¢çš„â€œå–œæ¬¢â€åšå®¢æ–‡ç« çš„ç¤ºä¾‹ï¼‰ï¼Œåˆ™å…¶å®ç°ç±»å‹å¯ä»¥ä¸ºæ¯ä¸ªè¢«ä¿®æ”¹çš„ç±»å‹åŒ…æ‹¬ä¸€ä¸ªå•ç‹¬çš„å­—æ®µï¼š</p><pre>type LikePostMutationResponse implements MutationResponse {  code: String!  success: Boolean!  message: String!  post: Post  user: User}</pre><p>ç”±äºæˆ‘ä»¬çš„å‡è®¾likePostçªå˜ä¼šåŒæ—¶ä¿®æ”¹Postå’ŒUserï¼Œå› æ­¤å…¶è¿”å›å¯¹è±¡åŒ…æ‹¬è¿™ä¸¤ç§ç±»å‹çš„å­—æ®µã€‚è¿”å›å€¼å…·æœ‰ä»¥ä¸‹ç»“æ„ï¼š</p><pre>{  "data": {    "likePost": {      "code": "200",      "success": true,      "message": "Thanks!",      "post": {        "id": "123",        "likes": 5040      },      "user": {        "likedPosts": ["123"]      }    }  }}</pre><p>éµå¾ªæ­¤æ¨¡å¼ä¸ºå®¢æˆ·ç«¯å…³æ¯ä¸ªè¯·æ±‚çš„æ“ä½œç»“æœæä¾›æœ‰ç”¨çš„è¯¦ç»†ä¿¡æ¯ã€‚æœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œå¼€å‘äººå‘˜å¯ä»¥æ›´å¥½åœ°åº”å¯¹å…¶å®¢æˆ·ç«¯ä»£ç ä¸­çš„æ“ä½œå¤±è´¥ã€‚</p><h4 id="è‡ªå®šä¹‰æ ‡é‡ç±»å‹å’Œæšä¸¾ç±»å‹"><a href="#è‡ªå®šä¹‰æ ‡é‡ç±»å‹å’Œæšä¸¾ç±»å‹" class="headerlink" title="è‡ªå®šä¹‰æ ‡é‡ç±»å‹å’Œæšä¸¾ç±»å‹"></a>è‡ªå®šä¹‰æ ‡é‡ç±»å‹å’Œæšä¸¾ç±»å‹</h4><h4 id="è”åˆä¸æ¥å£"><a href="#è”åˆä¸æ¥å£" class="headerlink" title="è”åˆä¸æ¥å£"></a>è”åˆä¸æ¥å£</h4><h4 id="ä½¿ç”¨schemaæŒ‡ä»¤"><a href="#ä½¿ç”¨schemaæŒ‡ä»¤" class="headerlink" title="ä½¿ç”¨schemaæŒ‡ä»¤"></a>ä½¿ç”¨schemaæŒ‡ä»¤</h4><h4 id="æ‰§è¡ŒæŒ‡ä»¤"><a href="#æ‰§è¡ŒæŒ‡ä»¤" class="headerlink" title="æ‰§è¡ŒæŒ‡ä»¤"></a>æ‰§è¡ŒæŒ‡ä»¤</h4>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>prototype/this</title>
    <link href="/2020/07/06/prototype/this/"/>
    <url>/2020/07/06/prototype/this/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Promise è¯¦è§£</title>
    <link href="/2020/07/06/promise/1/"/>
    <url>/2020/07/06/promise/1/</url>
    
    <content type="html"><![CDATA[<p>new Promiseæ—¶ï¼Œ éœ€è¦ä¼ é€’ä¸€ä¸ª executor æ‰§è¡Œå™¨ï¼Œ æ‰§è¡Œå™¨ç«‹å³æ‰§è¡Œ</p><a id="more"></a><p>/**</p><ul><li><ol><li>new Promiseæ—¶ï¼Œ éœ€è¦ä¼ é€’ä¸€ä¸ª executor æ‰§è¡Œå™¨ï¼Œ æ‰§è¡Œå™¨ç«‹å³æ‰§è¡Œ</li></ol></li><li><ol start="2"><li>executor æ¥å—ä¸¤ä¸ªå‚æ•° åˆ†åˆ«æ˜¯ resolve å’Œ reject</li></ol></li><li><ol start="3"><li>promise åªèƒ½ä» pending åˆ° rejectedï¼Œ æˆ–è€… ä» pending åˆ° resolved</li></ol></li><li><ol start="4"><li>promise çš„çŠ¶æ€ä¸€æ—¦ç¡®è®¤ï¼Œ å°±ä¸ä¼šå†æ”¹å˜</li></ol></li><li><ol start="5"><li>promise éƒ½æœ‰ then æ–¹æ³•ï¼Œ thenæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œ </li></ol></li><li>åˆ†åˆ«æ˜¯ promise æˆåŠŸå›è°ƒçš„ onFulfilled å’Œ å¤±è´¥å›è°ƒçš„ onRejected</li><li><ol start="6"><li>å¦‚æœè°ƒç”¨ then æ—¶ï¼Œpromiseå·²ç»æˆåŠŸï¼Œåˆ™æ‰§è¡Œ onFulfilled å¹¶å°† promiseçš„å€¼ä½œä¸ºå‚æ•°ä¼ è¿›å»</li></ol></li><li>å¦‚æœpromiseå·²ç»å¤±è´¥ï¼Œ é‚£ä¹ˆæ‰§è¡Œ onRejected å¹¶å°† promiseå¤±è´¥çš„åŸå› ä½œä¸ºå‚æ•°ä¼ é€’è¿›å»</li><li>å¦‚æœpromiseæ˜¯pendingçŠ¶æ€ï¼Œåˆ™æŠŠ onFulfilled å’Œ onRejected å‡½æ•°å­˜èµ·æ¥ï¼Œ ç­‰åˆ°çŠ¶æ€ç¡®å®šåï¼Œ</li><li>å†æŒ‰ç…§ç›¸åº”çš„å¯¹è±¡æ‰§è¡Œï¼ˆå‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼‰</li><li><ol start="7"><li>onFulfilled å’Œ onRejected çš„å‚æ•°å¯ä»¥ç¼ºçœ</li></ol></li><li><ol start="8"><li>promise å¯ä»¥ then å¤šæ¬¡ï¼Œpromiseçš„then è¿”å›ä¸€ä¸ªpromise</li></ol></li><li><ol start="9"><li>å¦‚æœthenè¿”å›çš„æ˜¯ä¸€ä¸ªç»“æœï¼Œ é‚£ä¹ˆå¯ä»¥æŠŠè¿™ä¸ªç»“æœä½œä¸ºå‚æ•°ï¼Œä¼ é€’ä¸‹ä¸€ä¸ªthen çš„ onFulfilledæˆåŠŸçš„å›è°ƒ</li></ol></li><li><ol start="10"><li>å¦‚æœthen è¿”å›çš„æ˜¯ä¸€ä¸ªå¼‚å¸¸ï¼Œ é‚£ä¹ˆå¯ä»¥æŠŠè¿™ä¸ªå¼‚å¸¸ä½œä¸ºå‚æ•°ï¼Œ ä¼ é€’ç»™ä¸‹ä¸€ä¸ªthen çš„ onRejected å¤±è´¥å›è°ƒ</li></ol></li><li><ol start="11"><li>å¦‚æœ then è¿”å›çš„æ˜¯ä¸€ä¸ªpromise, é‚£ä¹ˆéœ€è¦ç­‰è¿™ä¸ªpromise é‚£ä¹ˆç­‰åˆ°è¿™ä¸ªpromise æ‰§è¡Œå®Œ</li></ol></li><li>promiseæ‰§è¡ŒæˆåŠŸå°±èµ°ä¸‹ä¸€ä¸ªthenæˆåŠŸï¼Œ promiseæ‰§è¡Œå¤±è´¥å°±èµ°ä¸‹ä¸€ä¸ªthençš„å¤±è´¥</li><li>/</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PENDING = <span class="string">"pending"</span>;</span><br><span class="line"><span class="keyword">const</span> FULFILLED = <span class="string">"fulfilled"</span>;</span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="string">'rejected'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Promise</span>(<span class="params">excutor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> that = <span class="keyword">this</span>; <span class="comment">//ç¼“å­˜å½“å‰promise å®ä¾‹å¯¹è±¡</span></span><br><span class="line">  that.status = PENDING; <span class="comment">// åˆå§‹çŠ¶æ€</span></span><br><span class="line">  that.value = <span class="literal">undefined</span>; <span class="comment">// fulfilledçŠ¶æ€æ—¶ è¿”å›çš„ä¿¡æ¯</span></span><br><span class="line">  that.reason = <span class="literal">undefined</span>; <span class="comment">// rejectedçŠ¶æ€æ—¶ æ‹’ç»çš„åŸå› </span></span><br><span class="line">  that.onFulfilledCallbacks = []; <span class="comment">//å­˜å‚¨fulfilled çŠ¶æ€å¯¹åº”çš„onFulfilledå‡½æ•°</span></span><br><span class="line">  that.onRejectedCallbacks = []; <span class="comment">//å­˜å‚¨rejected çŠ¶æ€å¯¹åº”çš„onRejected å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">resovle</span> (<span class="params">value</span>) </span>&#123; <span class="comment">//value æˆåŠŸæ€æ—¶æ¥å—çš„ç»ˆå€¼</span></span><br><span class="line">    <span class="keyword">if</span>(value <span class="keyword">instanceof</span> <span class="built_in">Promise</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> value.then(resovle, reject)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®è·µä¸­è¦ç¡®ä¿ onFulfilled å’Œ onRejectedæ–¹æ³•å¼‚æ­¥æ‰§è¡Œï¼Œ</span></span><br><span class="line">    <span class="comment">//ä¸”åº”è¯¥åœ¨then æ–¹æ³•è°ƒç”¨çš„æ—¶å€™é‚£ä¸€è½®äº‹ä»¶å¾ªç¯çš„æ‰§è¡Œæ ˆæ‰§è¡Œç»“æŸä¹‹å</span></span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// è°ƒç”¨resovle å›è°ƒå¯¹åº”çš„onFulfilledå‡½æ•°</span></span><br><span class="line">      <span class="keyword">if</span> (that.status === PENDING) &#123;</span><br><span class="line">        <span class="comment">// åªèƒ½ç”±pendingçŠ¶æ€ =ã€‹ fulfilled çŠ¶æ€ï¼ˆé¿å…å¤šæ¬¡è°ƒç”¨resovle rejectï¼‰</span></span><br><span class="line">        that.status = FULFILLED;</span><br><span class="line">        that.value = value;</span><br><span class="line">        that.onFulfilledCallbacks.forEach(<span class="function"><span class="params">callback</span> =&gt;</span> &#123;</span><br><span class="line">          callback(that.value)</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">reason</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// è°ƒç”¨reject å›è°ƒå¯¹åº”onRejected å‡½æ•°</span></span><br><span class="line">        <span class="keyword">if</span> (that.status === PENDING) &#123;</span><br><span class="line">          <span class="comment">// åªèƒ½ç”± pending =ã€‹ rejected ï¼ˆé¿å…å¤šæ¬¡è°ƒç”¨resovle rejectï¼‰</span></span><br><span class="line">          that.status = REJECTED;</span><br><span class="line">          that.reason = reason;</span><br><span class="line">          that.onRejectedCallbacks.forEach(<span class="function"><span class="params">callback</span> =&gt;</span> &#123;</span><br><span class="line">            callback(that.reason)</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//æ•è·åœ¨excutoræ‰§è¡ŒæœŸç‚®æ•°çš„å¼‚å¸¸</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    excutor(resovle, reject)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    reject(e)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Promise.prototype.then = function(onFulfilled, onRejected) {<br>  const that = this;<br>  let newPromise;<br>  onFulfilled =<br>    typeof onFulfilled === â€œfunctionâ€ ? onFulfilled : value =&gt; value;<br>  onRejected =<br>   typeof onRejected === â€œfunctionâ€ ? onRejected : reason =&gt; {<br>     throw reason<br>   }</p><p>   if(that.status === FULFILLED) {<br>     return newPromise = new Promise((resovle, reject) =&gt; {<br>       setTimeout(() =&gt; {<br>         try {<br>           let x = onFulfilled(that.value)<br>           resovlePromise(newPromise, x, resovle, reject);<br>         } catch (error) {<br>           reject(error)<br>         }<br>       })<br>     })<br>   }</p><p>   if(that.status === REJECTED) {<br>     return newPromise = new Promise(() =&gt; {<br>       setTimeout(() =&gt; {<br>         try {<br>           let x = onRejected(that.reason)<br>           resovlePromise(newPromise, x, resovle, reject)<br>         } catch (error) {<br>           reject(error)<br>         }<br>       })<br>     })<br>   }</p><p>   if(that.status === PENDING) {<br>     that.onFulfilledCallbacks.push(() =&gt; {<br>        setTimeout(() =&gt; {<br>          try {<br>            let x = onFulfilled(that.value)<br>            resovlePromise(newPromise, x, resovle, reject)<br>          } catch (error) {<br>            reject(error)<br>          }<br>        })<br>     })</p><pre><code>that.onRejectedCallbacks.push(() =&gt;{  setTimeout(() =&gt; {    try {      let x = onRejected(that.reason)      resovlePromise(newPromise, x, resovle, reject)    } catch (error) {      reject(error)    }  })})</code></pre><p>  }</p><p>}</p><p>function resovlePromise (newPromise, x, resolve, reject) {<br>  let that = this;<br>  if(newPromise === x) {<br>    reject(new TypeError(â€˜Chaining cycleâ€™));<br>  }<br>  if(x &amp; typeof x === â€˜objectâ€™ || typeof x === â€˜functionâ€™) {<br>    let used;<br>    try {<br>      let then = x.then;<br>      if(typeof then === â€˜functionâ€™) {<br>        then.call(x, (y) =&gt; {<br>          if(used) return;<br>          used === true;<br>          resovlePromise(newPromise, y, resolve, reject);<br>        }, (reason) =&gt; {<br>          if(used) return;<br>          used === true;<br>          reject(reason);<br>        })<br>      }else {<br>        if(used) return;<br>        used = true;<br>        resolve(x);<br>      }<br>    } catch (error) {<br>      if(used) return;<br>      used = true;<br>      reject(error);<br>    }<br>  }else{<br>    resolve(x);<br>  }<br>}</p><p>// promise.finally<br>// ä¸ç®¡æˆåŠŸ or å¤±è´¥ æœ€ç»ˆéƒ½ä¼šèµ°åˆ°finally è¿˜å¯ä»¥ç»§ç»­ then ä¸”å¯ä»¥æŠŠå€¼åŸå°ä¸åŠ¨çš„ä¼ ç»™åé¢çš„then<br>Promise.prototype.finally = function (callback) {<br>  return this.then((value) =&gt; {<br>    return Promise.resolve(callback()).then(() =&gt; {<br>      return value<br>    })<br>  }, (err) =&gt; {<br>    return Promise.resolve(callback().then(() =&gt; {<br>      throw err<br>    }))<br>  })<br>}</p><p>//promise.allï¼ˆpromisesï¼‰ è¿”å›ä¸€ä¸ªpromiseå¯¹è±¡<br>/**</p><ul><li><ol><li>å¦‚æœä¼ å…¥çš„æ˜¯ä¸€ä¸ªç©ºçš„å¯è¿­ä»£å¯¹è±¡ï¼Œé‚£ä¹ˆæ­¤promiseå¯¹è±¡å›è°ƒå®Œæˆï¼ˆresolveï¼‰ï¼Œ</li></ol></li><li><p>åªæœ‰è¿™ç§æƒ…å†µæ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œå…¶ä»–çš„éƒ½æ˜¯è¿”å›ä¸€ä¸ªå¼‚æ­¥å®Œæˆ</p></li><li><ol start="2"><li>å¦‚æœä¼ å…¥å‚æ•°ä¸åŒ…å«ä»»ä½•ä¸€ä¸ªpromiseï¼Œ åˆ™è¿”å›ä¸€ä¸ªå¼‚æ­¥å®Œæˆ</li></ol></li><li><ol start="3"><li>promises æ‰€æœ‰çš„promiseéƒ½å®Œæˆæ—¶ï¼Œæˆ–å‚æ•°ä¸­ä¸åŒ…å«promiseæ—¶ å›è°ƒå®Œæˆ</li></ol></li><li><ol start="4"><li>å¦‚æœä¸€ä¸ª promise å¤±è´¥ï¼Œé‚£ä¹ˆpromise.all è¿”å›çš„promiseå¯¹è±¡å¤±è´¥</li></ol></li><li><ol start="5"><li>åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œpromisesè¿”å›çš„promiseçš„å®ŒæˆçŠ¶æ€ç»“æœéƒ½æ˜¯ä¸€ä¸ªæ•°ç»„</li></ol></li><li><p>/</p><p>Promise.prototype.all = function (promises) {<br> return new Promise((resolve, rejected) =&gt; {<br>  let index = 0;<br>  let result = [];<br>  if (promises.length === 0) {</p><pre><code>resolve(result)</code></pre><p>  } else {</p><pre><code>function processValue (idx, data) {  result[i] = data;  if (++index === promises.length) {    resolve(result)  }}for (let i = 0; i &lt; promises.length; i++) {  //promises[i]å¯èƒ½æ˜¯ä¸ªæ™®é€šå€¼  Promise.resolve(promises[i]).then((data) =&gt; {    processValue(i, data)  }, (err) =&gt; {    rejected(err);    return;  })}</code></pre><p>  }<br> })<br>}</p></li></ul><p> //Promise.race()<br> /**</p><ul><li>è¿”å›ä¸€ä¸ªpromiseå‡½æ•°ï¼Œä»–å°†ä¸ç¬¬ä¸€ä¸ªä¼ é€’çš„promiseç›¸åŒçš„æ–¹å¼è¢«å®Œæˆï¼Œä»–å¯ä»¥æ˜¯å®Œæˆä¹Ÿå¯ä»¥æ˜¯å¤±è´¥ï¼Œ</li><li>å–å†³äºç¬¬ä¸€ä¸ªå®Œæˆçš„æ–¹å¼æ˜¯ä¸¤ä¸ªä¸­çš„å“ªä¸€ä¸ª</li><li>å¦‚æœä¼ é€’çš„æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ï¼Œé‚£ä¹ˆprimiseå°†å¤„äºæ°¸è¿œç­‰å¾…</li><li>å¦‚æœè¿­ä»£ä¸­åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª épromise/resolve/rejectçš„promiseï¼Œé‚£ä¹ˆpromise.raceå°†è§£æä¸ºè¿­ä»£ä¸­æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªå€¼</li><li>/<br>Promise.prototype.race = function(promises) {<br>return new Promise((resovle, reject) =&gt; {<br> if(promises.length === 0) {<br>   return;<br> }else {<br>   for (let i = 0; i &lt; promises.length; i++) {<pre><code>Promise.resolve(promises[i]).then((data)=&gt; {  resolve(data);  return;}, (err) =&gt; {  reject(err);  return;})</code></pre>   }<br> }<br>})<br>}</li></ul><p>//Promise.allSettled<br>/**</p><ul><li><p>å°†ä¸€ç»„promiseå®ä¾‹ä½œä¸ºå‚æ•°ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„promiseå®ä¾‹ï¼Œåªæœ‰ç­‰åˆ°æ‰€æœ‰çš„promiseéƒ½æ‰§è¡Œå®Œæˆå</p></li><li><p>ä¸ç®¡æ˜¯fulfilled æˆ–æ˜¯ rejected åŒ…è£…å®ä¾‹æ‰ä¼šç»“æŸ</p></li><li><p>/</p><p>//Promise.any<br>/**</p></li><li><p>å°†ä¸€ç»„promiseå®ä¾‹ä½œä¸ºå‚æ•°ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„promiseå®ä¾‹ï¼Œå®ä¾‹å‚æ•°åªè¦æœ‰ä¸€ä¸ªpromiseæ˜¯resolveçŠ¶æ€</p></li><li><p>åŒ…è£…çš„å®ä¾‹åˆ™è¿”å›resolveçŠ¶æ€ï¼Œå¦‚æœå®ä¾‹å‚æ•°éƒ½è¿”å›rejectedçŠ¶æ€ï¼Œå®ä¾‹æ‰è¿”å› rejected</p></li><li><p>/</p></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>prototype/prototype</title>
    <link href="/2020/07/06/prototype/prototype/"/>
    <url>/2020/07/06/prototype/prototype/</url>
    
    <content type="html"><![CDATA[<h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h2><hr><p><strong>constructor</strong> è¿”å›å®ä¾‹å¯¹è±¡æ„é€ å‡½æ•°çš„å¼•ç”¨ï¼Œæ­¤å€¼æ˜¯å¯¹å‡½æ•°æœ¬èº«çš„å¼•ç”¨</p><pre>function Person (name) {    this.name = name;}var p = new Person(name);p.constructor === Person</pre><p>æ„é€ å‡½æ•°æœ¬èº«å°±æ˜¯å‡½æ•°ï¼Œä¸è¿‡ä¸ºäº†è§„èŒƒéƒ½ä¼šé¦–å­—æ¯å¤§å†™ï¼Œ ä¸»è¦<code>åŒºåˆ«</code>åœ¨äºä½¿ç”¨ <em>new</em> ç”Ÿæˆçš„å®ä¾‹å‡½æ•°å°±æ˜¯æ„é€ å‡½æ•°ï¼Œç›´æ¥è°ƒç”¨çš„å°±æ˜¯æ™®é€šå‡½æ•° </p><h3 id="constructor-æ˜¯åªè¯»çš„å—ï¼Ÿ"><a href="#constructor-æ˜¯åªè¯»çš„å—ï¼Ÿ" class="headerlink" title="constructor æ˜¯åªè¯»çš„å—ï¼Ÿ"></a>constructor æ˜¯åªè¯»çš„å—ï¼Ÿ</h3><p>å¯¹å¼•ç”¨ç±»å‹æ¥æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œå¯¹åŸºæœ¬æ•°æ®ç±»å‹æ˜¯ åªè¯»çš„</p><pre>function Parent() {    this.name = 'xiaoming';    this.age = '18';}Parent.prototype = {    method: funtion () {}}function Children() {}Children.prototype = new Parent();Children.prototype.foo = 'Hello world'//æ­¤æ—¶constructor æŒ‡å‘ ObjectChildren.prototype.constructor === Object //true//ä¿®æ­£constructorChildren.prototype.constructor = Children</pre><h3 id="new-åˆ°åº•æ˜¯å¦‚æœå®ç°çš„å‘¢"><a href="#new-åˆ°åº•æ˜¯å¦‚æœå®ç°çš„å‘¢" class="headerlink" title="new åˆ°åº•æ˜¯å¦‚æœå®ç°çš„å‘¢"></a>new åˆ°åº•æ˜¯å¦‚æœå®ç°çš„å‘¢</h3><pre>function create () {    // åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡    var obj = new Object(),    //2. è·å¾—æ„é€ å‡½æ•°ï¼ŒåŒæ—¶åˆ é™¤arguments é‡Œçš„ç¬¬ä¸€ä¸ªå‚æ•°    Con = [].shift.call(arguments);    //3. é“¾æ¥åˆ°åŸå‹ï¼Œobjå¯ä»¥è®¿é—®åˆ°æ„é€ å‡½æ•°çš„å±æ€§    Object.setPrototypeOf(obj, Con.prototype)    //4.ç»‘å®šthiså®ç°ç»§æ‰¿ï¼Œè®©å…¶å¯ä»¥è®¿é—®æ„é€ å‡½æ•°çš„å±æ€§    var result = Con.apply(obj, arguments)    //ä¼˜å…ˆè¿”å›æ„é€ å‡½æ•°çš„å¯¹è±¡    return result instanceof Object ? result : obj}</pre><h2 id="åŸå‹-prototype"><a href="#åŸå‹-prototype" class="headerlink" title="åŸå‹ prototype"></a>åŸå‹ prototype</h2><p>æ¯ä¸ªæ„é€ å‡½æ•°å¯¹è±¡æ‹¥æœ‰ä¸€ä¸ª<strong>åŸå‹å¯¹è±¡</strong>ï¼Œå¯¹è±¡ä»¥åŸå‹ä¸ºæ¨¡æ¿ï¼Œä»åŸå‹ç»§æ‰¿æ–¹æ³•å’Œå±æ€§ï¼Œè¿™äº›å±æ€§å’Œæ–¹æ³•å®šä¹‰åœ¨æ„é€ å™¨å‡½æ•°çš„ <strong>prototype</strong> å±æ€§ä¸Šï¼Œè€Œéæœ¬èº«</p><h2 id="proto"><a href="#proto" class="headerlink" title="_proto_"></a>_<em>proto_</em></h2><p>æ„é€ å‡½æ•°çš„ prototype å±æ€§æœ‰ä¸ª _<em>proto__å±æ€§ï¼Œè¿™æ˜¯ä¸€ä¸ªè®¿é—®å™¨å±æ€§ï¼ˆå³getter å‡½æ•°å’Œ setterå‡½æ•°ï¼‰ï¼Œé€šè¿‡ä»–å¯ä»¥è®¿é—®åˆ°å¯¹è±¡å†…éƒ¨çš„ [[Prototype]](ä¸€ä¸ªå¯¹è±¡æˆ–null)<br>##<br><em>_prototype</em></em> å±æ€§åœ¨es6åæ‰è¢«æ ‡å‡†åŒ–ï¼Œè·å–æˆ–è€…è®¾ç½®å¯ä»¥ç”¨</p><pre>    Object.setPrototypeOf()    Object.getPrototypeOf()</pre><p>##åŸå‹é“¾<br>æ¯ä¸ªå¯¹è±¡æ‹¥æœ‰åŸå‹å¯¹è±¡ï¼Œé€šè¿‡<strong>proto</strong>æŒ‡é’ˆæŒ‡å‘è¯¥å¯¹è±¡çš„åŸå‹ï¼Œå¹¶ä»ä¸­é›†æˆæ–¹æ³•å’Œå±æ€§ï¼Œ åŒæ—¶åŸå‹å¯¹è±¡ä¹Ÿå¯èƒ½æ‹¥æœ‰åŸå‹ï¼Œè¿™æ ·ä¸€å±‚ä¸€å±‚ï¼Œæœ€ç»ˆä¼šæŒ‡å‘nullï¼›è¿™ç§å…³ç³»è¢«ç§°ä½œåŸå‹é“¾</p><h2 id="å®ç°-instanceOf"><a href="#å®ç°-instanceOf" class="headerlink" title="å®ç° instanceOf"></a>å®ç° instanceOf</h2><pre>function _instanceOf (instance, object){    // è·å–å¯¹è±¡çš„åŸå‹    const prototype = object.prototype;    //è·å–è¦æ£€æŸ¥å¯¹è±¡çš„åŸå‹    let proto = instance.__proto__;    //éå†è¦æ£€æŸ¥çš„åŸå‹é“¾ï¼Œuntil the end of instance    while (__proto__ !== null) {        if (__proto__ === prototype) {            return true;        }        proto =  proto.__proto__;    }    return false;}</pre>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>http/http</title>
    <link href="/2020/07/06/http/http/"/>
    <url>/2020/07/06/http/http/</url>
    
    <content type="html"><![CDATA[<h2 id="http-ç®€ä»‹"><a href="#http-ç®€ä»‹" class="headerlink" title="http ç®€ä»‹"></a>http ç®€ä»‹</h2><p>http è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œä¸»è¦è§„å®šæµè§ˆå™¨å’ŒæœåŠ¡å™¨ç›¸äº’é€šä¿¡è§„åˆ™ï¼Œå®ƒæ˜¯åŸºäºTCP/IPé€šä¿¡åè®®æ¥è¿›è¡Œä¼ é€’æ•°æ®<br>æµè§ˆå™¨å‘èµ·ä¸€httpè¯·æ±‚ï¼Œ é¦–å…ˆå»ºç«‹TCPè¿æ¥  ä¹Ÿå°±æ˜¯å¸¸è¯´çš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œ æ¥ä¸‹æ¥å‘èµ·Httpè¯·æ±‚<br>ä¸€ä¸ªhttpè¯·æ±‚ä¸»è¦åŒ…æ‹¬ è¯·æ±‚è¡Œ è¯·æ±‚å¤´ è¯·æ±‚æ­£æ–‡<br>è¯·æ±‚è¡Œï¼šè¯·æ±‚åœ°å€ã€è¯·æ±‚çš„æ–¹æ³•ï¼ˆgetï¼Œ postã€putã€deleteï¼‰ã€è¯·æ±‚çŠ¶æ€<br>2** æˆåŠŸ<br>#excerpt_link: Read Moreâ€¦<br>3** é‡å®šå‘<br>    301 æ°¸ä¹…é‡å®šå‘<br>    302 ä¸´æ—¶é‡å®šå‘<br>    304 not modify<br>4** å®¢æˆ·ç«¯é”™è¯¯<br>    400 Bad request è¯·æ±‚ä¸­æœ‰è¯­æ³•é”™è¯¯<br>    401 Unauthorize æœªè¢«æˆæƒ<br>    403 forbidden<br>    404 Not found<br>5** æœåŠ¡ç«¯é”™è¯¯<br>    500<br>    503 service unavailable<br>è¯·æ±‚å¤´<br> Accept<br> host<br> UserAgent<br> cookie ï¼ˆkey value domin expires size httponlyï¼‰4k æœ€å¤šå¯ä»¥æœ‰20ä¸ª é»˜è®¤åˆ°æµè§ˆå™¨å…³é—­<br> connection keep-alive<br>è¯·æ±‚ä½“<br>http å“åº”è¯·æ±‚<br> å“åº”è¡Œ<br> å“åº”ä½“<br>  cache-control<br>  content-type<br>  status<br>  expires<br>  date<br>  Last-Modified<br>ç»“æŸ<br>æ–­å¼€ TCP è¿æ¥ å››æ¬¡æŒ¥æ‰‹</p><h2 id="https-http-ssl"><a href="#https-http-ssl" class="headerlink" title="https = http + ssl"></a>https = http + ssl</h2>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Gallery</title>
    <link href="/2020/07/06/hello-world/"/>
    <url>/2020/07/06/hello-world/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦â€¦</p><a id="more"></a><p>æ­£æ–‡â€¦</p><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><p><a href="source/data/promise/1.md">é˜…è¯»æ›´å¤šâ€¦</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>algorithm/throttle</title>
    <link href="/2020/07/06/algorithm/throttle/"/>
    <url>/2020/07/06/algorithm/throttle/</url>
    
    <content type="html"><![CDATA[<p>##èŠ‚æµå‡½æ•° throttle<br>###æ–¹æ¡ˆä¸€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function throttle(fn, time) &#123;</span><br><span class="line">    let previous &#x3D; 0</span><br><span class="line">    return function(...args) &#123;</span><br><span class="line">        const temp &#x3D; +new Date();</span><br><span class="line">        if(temp - previous &gt; time) &#123;</span><br><span class="line">            previous &#x3D; temp</span><br><span class="line">            fn.apply(this, args);</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é˜²æŠ–å‡½æ•°-debounce"><a href="#é˜²æŠ–å‡½æ•°-debounce" class="headerlink" title="é˜²æŠ–å‡½æ•° debounce"></a>é˜²æŠ–å‡½æ•° debounce</h4><h3 id="æ–¹æ¡ˆä¸€"><a href="#æ–¹æ¡ˆä¸€" class="headerlink" title="æ–¹æ¡ˆä¸€"></a>æ–¹æ¡ˆä¸€</h3><pre><code>function debounce(fn, time){    let timer = null;    return function(...args) {        if(!timer) {            timer = setTimeout(() =&gt; {                fn.call(this, args)            }, time)           }        clearTimeout(timer)    }}</code></pre>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ç§»åŠ¨ç«¯é€‚é…æ–¹æ¡ˆ</title>
    <link href="/2020/07/06/css/mobile/"/>
    <url>/2020/07/06/css/mobile/</url>
    
    <content type="html"><![CDATA[<p>###åƒç´ </p><h4 id="ç‰©ç†åƒç´ ï¼ˆè®¾å¤‡åƒç´ ï¼‰"><a href="#ç‰©ç†åƒç´ ï¼ˆè®¾å¤‡åƒç´ ï¼‰" class="headerlink" title="ç‰©ç†åƒç´ ï¼ˆè®¾å¤‡åƒç´ ï¼‰"></a>ç‰©ç†åƒç´ ï¼ˆè®¾å¤‡åƒç´ ï¼‰</h4><p>å±å¹•çš„ç‰©ç†åƒç´ ï¼Œåˆè¢«æˆä¸ºè®¾å¤‡åƒç´ ï¼Œæ˜¯ç°å®è®¾å¤‡ä¸­æœ€å¾®å°çš„ç‰©ç†éƒ¨ä»¶ï¼Œä»»ä½•è®¾å¤‡çš„å±å¹•çš„ç‰©ç†åƒç´ å‡ºå‚æ—¶å°±ç¡®å®šäº†ï¼Œä¸”å›ºå®šä¸å˜</p><h4 id="è®¾å¤‡ç‹¬ç«‹åƒç´ "><a href="#è®¾å¤‡ç‹¬ç«‹åƒç´ " class="headerlink" title="è®¾å¤‡ç‹¬ç«‹åƒç´ "></a>è®¾å¤‡ç‹¬ç«‹åƒç´ </h4><p>è®¾å¤‡ç‹¬ç«‹åƒç´ ä¹Ÿæˆä¸ºå¯†åº¦æ— å…³åƒç´ ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯è®¡ç®—æœºåæ ‡çš„ä¸€ä¸ªç‚¹ï¼Œè¿™ä¸ªç‚¹å¯ä»¥ä»£è¡¨ä¸€ä¸ªå¯ç”±ç¨‹åºä½¿ç”¨çš„è™šæ‹Ÿåƒç´ ï¼ˆä¾‹å¦‚cssåƒç´ ï¼‰ï¼Œç„¶åæœ‰ç›¸å…³ç³»ç»Ÿè½¬æ¢ä¸ºç‰©ç†åƒç´ </p><h4 id="è®¾å¤‡åƒç´ æ¯”ï¼ˆdevicePixelRatioï¼‰"><a href="#è®¾å¤‡åƒç´ æ¯”ï¼ˆdevicePixelRatioï¼‰" class="headerlink" title="è®¾å¤‡åƒç´ æ¯”ï¼ˆdevicePixelRatioï¼‰"></a>è®¾å¤‡åƒç´ æ¯”ï¼ˆdevicePixelRatioï¼‰</h4><p>ç®€ç§°dpr ï¼Œå®šä¹‰äº†ç‰©ç†åƒç´ å’Œè®¾å¤‡ç‹¬ç«‹åƒç´ çš„å¯¹åº”å…³50ç³»</p><pre>è®¾å¤‡åƒç´ æ¯” = ç‰©ç†åƒç´  / ç‹¬ç«‹è®¾å¤‡åƒç´ ä»¥iphone6 ä¸ºä¾‹  è®¾å¤‡å›ºæœ‰åƒç´ ä¸º 750 * 1334ï¼Œè®¾å¤‡å®½åº¦æ˜¯ 375 * 667ï¼Œå…¶ dpr å°±æ˜¯2å¯ä»¥é€šè¿‡ window.devicePixelRatio è·å¾—dpr > 1 å°±æ˜¯é«˜æ¸…å±ï¼Œä¸€èˆ¬dprä¸ºæ•´æ•°</pre><h4 id="cssåƒç´ "><a href="#cssåƒç´ " class="headerlink" title="cssåƒç´ "></a>cssåƒç´ </h4><p>cssã€jsä¸­ä½¿ç”¨çš„ä¸€ä¸ªé•¿åº¦å•ä½ã€‚å•ä½ px</p><p>æ³¨æ„ï¼špcç«¯1ç‰©ç†åƒç´  ç­‰äº1pxï¼Œä½†æ˜¯ç§»åŠ¨ç«¯1ç‰©ç†åƒç´ ä¸ç­‰äº 1pxï¼Œ1ç‰©ç†åƒç´ ä¸ pxçš„å…³ç³»ä¸ä»¥ä¸‹å› ç´ æœ‰å…³</p><pre>1.å±å¹•å¸ƒå±€çš„è§†å£å¤§å°2.å±å¹•çš„åˆ†è¾¨ç‡ï¼ˆç‰©ç†åƒç´ ï¼‰</pre><p>å¯¹äºä¸€å—å±å¹•ï¼Œå…¶ç‰©ç†åƒç´ æ˜¯ç¡®å®šçš„ã€‚è§†è§‰è§†å£å°ºå¯¸æ˜¯ç»§æ‰¿ä¸å¸ƒå±€è§†å£çš„ï¼Œè€Œè§†è§‰è§†å£é‡Œçš„å®½åº¦å³æ˜¯cssçš„pxæ•°ã€‚æ•…ä¸€å—å±å¹•ä¸Šçš„ç‰©ç†åƒç´ ä¸pxçš„å…³ç³»å°±æ˜¯ç‰©ç†åƒç´ ä¸å¸ƒå±€è§†å£çš„pxæ•°çš„å…³ç³»</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">æ¯”å¦‚ iPhone6 å®ƒçš„ç‰©ç†åƒç´ æ˜¯750pxï¼Œ å¦‚æœæ²¡æœ‰è®¾ç½®å¸ƒå±€è§†å£ viewport ä¸º 980px</span><br><span class="line">æ­¤æ—¶: 1ç‰©ç†åƒç´ é•¿åº¦ &#x3D; 980px &#x2F; 750px &#x3D; 1.3076px çš„é•¿åº¦</span><br><span class="line">ç”±äºåƒç´ éƒ½æ˜¯ç‚¹é˜µçš„ ä¸€ä¸ªç‰©ç†åƒç´ ç‚¹ç›¸å½“åº¦ 1.3076px * 1.3076px æ–¹æ ¼</span><br><span class="line"></span><br><span class="line">å½“åœ¨metaä¸­è®¾ç½®äº†å¦‚ä¸‹é…ç½®æ—¶</span><br><span class="line"></span><br><span class="line"> &lt;meta name &#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width&quot;&gt;</span><br><span class="line"> </span><br><span class="line">ç›¸å½“äºæŠŠå¸ƒå±€è§†å£è®¾ç½®ä¸ºè®¾å¤‡çš„å®½åº¦ï¼ˆå³ä¸Šé¢è®²åˆ°çš„è®¾å¤‡ç‹¬ç«‹åƒç´ ï¼‰ï¼Œ å¯¹äºiphone6å°±æ˜¯375</span><br><span class="line">æ­¤æ—¶ï¼š 1ç‰©ç†åƒç´ é•¿åº¦ &#x3D; 375px &#x2F; 750px &#x3D; 0.5 çš„é•¿åº¦ï¼Œç›¸å½“äº 0.5px * 0.5px æ–¹æ ¼</span><br></pre></td></tr></table></figure><h3 id="è§†å£"><a href="#è§†å£" class="headerlink" title="è§†å£"></a>è§†å£</h3><h4 id="1-å¸ƒå±€è§†å£"><a href="#1-å¸ƒå±€è§†å£" class="headerlink" title="1.å¸ƒå±€è§†å£"></a>1.å¸ƒå±€è§†å£</h4><p> åœ¨htmlä¸­ä¸€èˆ¬åœ¨metaä¸­çš„nameä¸ºviewport å­—æ®µå°±æ˜¯æ§åˆ¶çš„å¸ƒå±€è§†å£ï¼Œå¸ƒå±€è§†å£ä¸€èˆ¬éƒ½æ˜¯æµè§ˆå™¨å‚å•†ç»™çš„ä¸€ä¸ªå€¼ã€‚ä½†æ˜¯æµè§ˆå™¨å‚å•†ä¸€èˆ¬ä¸ºäº†èƒ½å°å±å¹•ä¹Ÿèƒ½å‹å¥½çš„å±•ç¤ºï¼ŒæŠŠå¸ƒå±€è§†å£è®¾ç½®å¾ˆå¤§ï¼Œä¸€èˆ¬åœ¨768px~1024oxä¹‹é—´ï¼Œæœ€å¸¸ç”¨çš„å°±æ˜¯980pxã€‚è¿™æ ·ç”¨æˆ·å°±èƒ½çœ‹å¤§ç»å¤§éƒ¨åˆ†çš„å†…å®¹ï¼Œæ ¹æ®å†…å®¹å»ç¼©æ”¾</p><p> æ•…å¸ƒå±€è§†å£æ˜¯çœ‹ä¸è§çš„ï¼Œæµè§ˆå™¨å‚å•†è®¾ç½®çš„å›ºå®šå€¼ï¼Œegï¼š980pxï¼Œå¹¶å°†980pxå†…å®¹ç¼©æ”¾åˆ°æ‰‹æœºå±å¹•å†…</p><p> å¸ƒå±€è§†å£å¯ä»¥é€šè¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.documentElement.clientWidth</span><br></pre></td></tr></table></figure><h4 id="2-è§†è§‰è§†å£"><a href="#2-è§†è§‰è§†å£" class="headerlink" title="2.è§†è§‰è§†å£"></a>2.è§†è§‰è§†å£</h4><p>æµè§ˆå™¨å¯è§†åŒºåŸŸçš„å¤§å°ï¼Œå³ç”¨æˆ·å¯ä»¥çœ‹åˆ°çš„åŒºåŸŸã€‚ï¼ˆå…¶å®½åº¦ç»§æ‰¿äºå¸ƒå±€è§†å£çš„å®½åº¦ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.innerwidth</span><br></pre></td></tr></table></figure><h4 id="3-ç†æƒ³è§†å£"><a href="#3-ç†æƒ³è§†å£" class="headerlink" title="3.ç†æƒ³è§†å£"></a>3.ç†æƒ³è§†å£</h4><p>å¸ƒå±€è§†å£è™½ç„¶è§£å†³äº†ç§»åŠ¨ç«¯ æŸ¥çœ‹pcç½‘é¡µçš„é—®é¢˜ï¼Œä½†æ˜¯å®Œå…¨å¿½ç•¥çš„æ‰‹æœºæœ¬èº«çš„å°ºå¯¸ã€‚æ‰€ä»¥è‹¹æœå¼•å…¥äº†ç†æƒ³è§†å£ï¼Œå®ƒå¯¹äºè®¾å¤‡æ¥è¯´å°±æ˜¯æœ€ç†æƒ³çš„å¸ƒå±€è§†å£,ç”¨æˆ·ä¸éœ€è¦ç¼©æ”¾å°±å¯ä»¥å®Œç¾å±•ç¤ºæ•´ä¸ªé¡µé¢</p><p>å¯ä»¥é€šè¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.screen.width</span><br></pre></td></tr></table></figure><p>ç§»åŠ¨ç«¯åˆ°åº•å¦‚ä½•é€‚é…å‘¢ æœ€ç®€å•å°±æ˜¯è®¾ç½®å¦‚ä¸‹è§†å£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width,initial-scale&#x3D;1,minimum-scale&#x3D;1,user-scalable&#x3D;no&quot;&gt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸Šè¿°æ–¹æ¡ˆå®šä¹‰å¸ƒå±€è§†æ—¶ï¼Œå³å¸ƒå±€è§†å£ç­‰äºç†æƒ³è§†å£ï¼Œå±å¹•æ²¡æœ‰æ»šåŠ¨æ¡ï¼Œä¸å­˜åœ¨é«˜æ¸…å±ä¸‹ï¼Œå­—ä½“è¾ƒå°çš„é—®é¢˜ã€‚ä½†æ˜¯åœ¨ä¸åŒçš„å±å¹•ä¸Šï¼Œè§†è§‰å®½åº¦æ˜¯ä¸åŒçš„ï¼Œä¸èƒ½ç®€å•çš„å°†æ‰€æœ‰çš„å°ºå¯¸éƒ½è®¾ç½®ä¸ºpxï¼Œ</p><h4 id="viewportç¼©æ”¾"><a href="#viewportç¼©æ”¾" class="headerlink" title="viewportç¼©æ”¾"></a>viewportç¼©æ”¾</h4><p>å¯¹äºä¸Šé¢è®¾ç½®ï¼Œåœ¨ä¸åŒçš„å±å¹•ä¸Šï¼Œcssåƒç´ å¯¹åº”çš„ç‰©ç†åƒç´ å…·ä½“çš„æ•°å€¼æ˜¯ä¸ä¸€è‡´çš„</p><p>åœ¨æ™®é€šå±å¹•ä¸Š dpr = 1 æ—¶ï¼Œ<br>1ä¸ªcssåƒç´ é•¿åº¦å¯¹åº”ä¸€ä¸ªç‰©ç†åƒç´ é•¿åº¦ï¼Œ1ä¸ªcssåƒç´ å¯¹åº”ä¸€ä¸ªç‰©ç†åƒç´ </p><p>åœ¨retinaå±å¹•ï¼Œ dpr = 2</p><p>1ä¸ªcssåƒç´ é•¿åº¦å¯¹åº” 2ä¸ªç‰©ç†åƒç´ é•¿åº¦ï¼Œ ä¸€ä¸ªcssåƒç´  å¯¹åº” 4ä¸ªç‰©ç†åƒç´ </p><h4 id="é€‚é…æ–¹æ¡ˆ"><a href="#é€‚é…æ–¹æ¡ˆ" class="headerlink" title="é€‚é…æ–¹æ¡ˆ"></a>é€‚é…æ–¹æ¡ˆ</h4><p>#####æ–¹æ¡ˆä¸€<br>å›ºå®šé«˜åº¦ å®½åº¦è‡ªé€‚åº”</p><p>ä½¿ç”¨ç†æƒ³è§†å£çš„æ–¹æ¡ˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width,initial-scale&#x3D;1,minumum-scale&#x3D;1,user-scalable&#x3D;no&quot; &gt;</span><br></pre></td></tr></table></figure><p>å‚ç›´æ–¹å‘ä½¿ç”¨å›ºå®šçš„å€¼ï¼Œæ°´å¹³æ–¹å‘ä½¿ç”¨å¼¹æ€§å¸ƒå±€ï¼Œå…ƒç´ ä½¿ç”¨å®šå€¼ ç™¾åˆ†æ¯” flex å¸ƒå±€</p><h5 id="æ–¹æ¡ˆäºŒï¼š"><a href="#æ–¹æ¡ˆäºŒï¼š" class="headerlink" title="æ–¹æ¡ˆäºŒï¼š"></a>æ–¹æ¡ˆäºŒï¼š</h5><p>å›ºå®šå¸ƒå±€è§†å£å®½åº¦ï¼Œä½¿ç”¨viewport ç¼©æ”¾</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">if(&#x2F;Android (\d+\.\d+)&#x2F;.test(navigator.userAgent))&#123;</span><br><span class="line">  var version &#x3D; parseFloat(RegExp.$1);</span><br><span class="line">  if(version&gt;2.3)&#123;</span><br><span class="line">    var phoneScale &#x3D; parseInt(window.screen.width)&#x2F;640;</span><br><span class="line">    if(&#x2F;MZ-M571C&#x2F;.test(navigator.userAgent))&#123;</span><br><span class="line">      document.write(&#39;&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;640, minimum-scale &#x3D; 0.5, maximum-scale&#x3D; 0.5&quot;&gt;&#39;);</span><br><span class="line">    &#125;else if(&#x2F;M571C&#x2F;.test(navigator.userAgent)&amp;&amp;&#x2F;LizhiFM&#x2F;.test(navigator.userAgent))&#123;</span><br><span class="line">      document.write(&#39;&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;640, minimum-scale &#x3D; 0.5, maximum-scale&#x3D; 0.5&quot;&gt;&#39;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      document.write(&#39;&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;640, minimum-scale &#x3D; &#39;+ phoneScale +&#39;, maximum-scale &#x3D; &#39;+ phoneScale +&#39;, target-densitydpi&#x3D;device-dpi&quot;&gt;&#39;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    document.write(&#39;&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;640, target-densitydpi&#x3D;device-dpi&quot;&gt;&#39;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">  document.write(&#39;&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;640, user-scalable&#x3D;no, target-densitydpi&#x3D;device-dpi&quot;&gt;&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–¹æ¡ˆä¸‰ï¼š</p><p>æ ¹æ®ä¸åŒçš„å±å¹•åŠ¨æ€å†™å…¥font-sizeï¼Œ ä»¥remä½œä¸ºå®½åº¦å•ä½ï¼Œ å›ºå®šå¸ƒå±€è§†å£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width,initial-scale&#x3D;1,minimum-scale&#x3D;1,maxmum-scale&#x3D;1,user-scalable&#x3D;no&quot; &gt;</span><br></pre></td></tr></table></figure><p>ä»¥640px è®¾è®¡ç¨¿ æˆ–è€… 750px è®¾è®¡ç¨¿ï¼Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var width &#x3D; document.document.clientWidth;</span><br><span class="line">var rem &#x3D; width &#x2F; 7.5</span><br><span class="line">var rem width &#x2F; 6.4</span><br></pre></td></tr></table></figure><p>æ–¹æ¡ˆå›› </p><p>ä»¥remä½œä¸ºå®½åº¦å•ä½ï¼ŒåŠ¨æ€å†™å…¥viewport å’Œ font-size è¿›è¡Œç¼©æ”¾</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>algorithm/linkedList</title>
    <link href="/2020/07/06/algorithm/linkedList/"/>
    <url>/2020/07/06/algorithm/linkedList/</url>
    
    <content type="html"><![CDATA[/** * é“¾è¡¨â€”â€”ä¸€ç§åŸºç¡€æ•°æ®ç»“æ„ * è‡ªèº«å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å¤´ç»“ç‚¹ï¼Œç›¸åº”çš„è¿™ä¸ªå¤´èŠ‚ç‚¹åˆæœ‰ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»¥æ­¤ç±»æ¨ã€‚ * æ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸¤å—åŒºåŸŸï¼Œæ•°æ®åŒºåŸŸåŒ…å«è¯¥ä½ç½®çš„å€¼ï¼Œå¦ä¸€ä¸ªåŒºåŸŸåŒ…å«ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ */function LinkList() {    this._length = 0;  // é•¿åº¦å±æ€§    this._head = null; // é“¾è¡¨æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸€å¼€å§‹çš„é“¾è¡¨ä¸ºç©º}LinkList.prototype = {    add: function(data) {        var node = {            data: data,            next: null        },        current;        if (this._head === null) {            this._head = node        } else {            current = this._head;            while (current.next) {                current = current.next            }            current.next = node        }        this._length++    },    item: function(index) {        if (index > -1 && index < this._length) {            var current = this._head,            i = 0;            while (i++ < index) {                current = current.next;            }            return current.data;        } else {            return null;        }    },    remove: function(index) {        if (index > -1 && index < this._length) {            var current = this._head,                previous,                i = 0;            if (index === 0) {                this._head = current.next            } else {                // æ‰¾åˆ°æ­£ç¡®çš„ä½ç½®è¿›è¡Œåˆ é™¤                while (i++ < index) {                    previous = current;                    current = current.next                }                previous.next = current.next            }            this._length--;            return current.data;        } else {            return null;        }    }}// ä½¿ç”¨var list = new LinkedList();list.add('red')list.add('orange')list.add('yellow')function showStudent(ssn) {    var student = db.get(ssn);    if(student !== null) {        document.querySelector(`#{elementId}`).innerHTML = `${student.ssn}, ${student.firstname}, ${student.lastname}`;    } else {        throw  new Error('student is not found')    }}var find = curry(function (db, id) {    var obj = bd.get(id);    if(obj === null) {        throw new Error('Object not found');    }    return obj;})var csv = (student) {    return `${student.ssn}, ${student.firstname}, ${student.lastname}`;}var append = curry(function (elementId, info) {    document.querySelector(elementId).innerHTML = info;})var showStudent = run(append('#student-info'), csv, find(db));class Person {    constructor(firstname, lastname, ssn) {        this._firstname = firstname;        this._lastname = lastname;        this._ssn = ssn;        this._address = null;        this._birthYear = null;    }    get ssn() {        return this._ssn;    }    get firstname() {        return this._firstname;    }    get address() {        return this._address;    }    get birthYear() {        return this._birthYear;    }    set address(addr) {        this._address = addr;    }    toString() {        return `Person(${this._firstname}, ${this._lastname})`    }}class Student extends Person {    constructor(firtname, lastname, ssn, school) {        super(firtname, lastname, ssn);        this._school = school    }    get school() {        return this._school;    }}]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>algorithm/base64</title>
    <link href="/2020/07/06/algorithm/base64/"/>
    <url>/2020/07/06/algorithm/base64/</url>
    
    <content type="html"><![CDATA[function generateArray(length, arr = []) {  let randomNum = Math.floor((Math.random()*30)+2);  if(arr.indexOf(randomNum) === -1) {    arr.push(randomNum);  }  return arr.length < length ? generateArray(length, arr) : arr ;}function toFlat(arr, newArr = []) {  for (let key in arr) {    console.log(arr[key])    typeof arr[key] === 'number' ? newArr.push(arr[key]) : toFlat(arr[key], newArr);  }  return Array.from(new Set(newArr)).sort((a, b) =>{ return a - b});}// class LazyMan {//   constructor(name) {//     this.name = name//     console.log(`Hi I am ${name}`)//   }//   sleep(time) {//     setTimeout(() => {//       console.log(`ç­‰å¾…äº†${time}`)//     }, time)//   }//   eat(some) {//     console.log(`I am eating ${some}`)//   }// }function LazyMan(name) {  if(! (this instanceof  LazyMan)) {    return  new LazyMan(name)  }  this.taskList = [];  this.next();  console.log(`Hi I am ${name}`);}LazyMan.prototype.sleep = function(time) {  let that = this  that.taskList.push({    delayTime: time * 1000,    callback() {      console.log(`ç­‰å¾…äº†${time}s ...`)      that.next()    }  })  return this;}LazyMan.prototype.eat = function(food) {  let that = this  that.taskList.push({    delayTime: 0,    callback() {      console.log(`I am eating ${food}`)      that.next()    }  })  return that;}LazyMan.prototype.next = function() {  const taskList = this.taskList;  if ( taskList.length === 0 ) return;  const {delayTime, callback} = taskList[0]  setTimeout(() => {    callback && callback()    taskList.shift()    this.next()  },delayTime)}LazyMan('Tony').sleep(10).eat('lunch');function add() {  let args = [].slice.call(arguments);  let addArgs = args.length === 1 ? args[0] : args.reduce((pre, item) => {    return pre + item  })  function sumF() {    let addArgs2 = args.length === 1 ? args[0] : args.reduce((pre, item) => {      return pre + item    })    return addArgs += addArgs2  }  sumF.toString = function () {    return addArgs  }  return sumF;}]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>algorithm/BubbleSort</title>
    <link href="/2020/07/06/algorithm/BubbleSort/"/>
    <url>/2020/07/06/algorithm/BubbleSort/</url>
    
    <content type="html"><![CDATA[/** * å†’æ³¡æ’åº * æ¯”è¾ƒå‰ä¸¤ä¸ªå…ƒç´  -> å¦‚æœç¬¬ä¸€ä¸ªå…ƒç´ åº”è¯¥æ’åœ¨ç¬¬äºŒä¸ªåé¢ï¼Œåˆ™ä¸¤è€…äº¤æ¢ -> æ¯”è¾ƒç¬¬äºŒä¸ªä¸ç¬¬ä¸‰ä¸ªå…ƒç´   * å¦‚æœç¬¬äºŒä¸ªå…ƒç´ åº”è¯¥åœ¨ç¬¬ä¸‰ä¸ªåé¢ï¼Œä¸¤è€…äº¤æ¢ -> é‡å¤ä»¥ä¸Šè¿‡ç¨‹çŸ¥é“æœ«å°¾ * æ—¶é—´å¤æ‚åº¦ å¹³å‡å¤æ‚åº¦O(n*n), æœ€å¥½æƒ…å†µO(n), æœ€å·®æƒ…å†µ(n*n) * ç©ºé—´å¤æ‚åº¦ O(1) * ç¨³å®šæ€§ ç¨³å®š */function swap(items, firstIndex, secondIndex) {    var temp = items[firstIndex];    items[firstIndex] = items[secondIndex]    items[secondIndex] = temp}/** * å¤–å±‚å¾ªç¯è´Ÿè´£éå†ï¼Œå†…å±‚å¾ªç¯è´Ÿè´£æ•°ç»„çš„å…ƒç´ æ¯”è¾ƒ *  */function bubbleSort(items) {    var len = items.length,            i,            j,            stop;    for (i = 0; i < len; i++) {        var done = true        for(j = 0, stop = len-i-1; j < stop; j++) {            if(items[j] < item[j+1]) {                swap(items, j, j+1)                done = false            }        }        if (done) {            break;        }    }    return items}]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>algorithm/BinarySearchTree</title>
    <link href="/2020/07/06/algorithm/BinarySearchTree/"/>
    <url>/2020/07/06/algorithm/BinarySearchTree/</url>
    
    <content type="html"><![CDATA[/** * äºŒå‰æœç´¢æ ‘ * æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰æ•°æ®ï¼Œå¦å¤–å«æœ‰ä¸¤ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å…¶ä»–èŠ‚ç‚¹ * ç‰¹ç‚¹ï¼šèŠ‚ç‚¹é¡ºåºåŸºäºèŠ‚ç‚¹å€¼çš„å¤§å°ï¼Œæ‰€æœ‰å·¦èŠ‚ç‚¹çš„å€¼éƒ½å°äºå³èŠ‚ç‚¹çš„å€¼ */var node = {    value: 124,    left: null,    right: null};function BinarySearchTree() {    this._root = null}BinarySearchTree.prototype = {    constructor: BinarySearchTree,    add: function (value) {        var node = {            value: value,            left: null,            right: null        },        current;        if (this._root === null) {            this._root = node;        } else {            current = this._root            while (true) {                if(value < current.value) {                    if (current.left === null) {                        current.left = node                        break;                    } else {                        current = current.left                    }                } else if (value >  current.right) {                    if (current.right === null) {                        current.right = node                        break                    } else {                        current = current.right                    }                } else {                    break                }            }        }    },    contains: function (value) {        var found = false,            current = this._root;        while (!found && current) {            if (value < current.value) {                current = current.right            } else if (value > current.value) {                current = current.left            } else {                found = true            }        }        return found        },    remove: function (value) {        var found = false,            parent = null,            current = this._root,            childCount,            replacement,            replacementParent;       // å®šä½è¦åˆ é™¤çš„èŠ‚ç‚¹ çˆ¶èŠ‚ç‚¹è¦è¢«è®°å½•              while(!found && current) {            if(value < current.value) {                parent = current                current = current.left            }else if (value > current.value) {                parent = current                current = current.right            } else {                found = true            }        }        if (found) {          // è®¡ç®—èŠ‚ç‚¹æ•°é‡            childCount = (current.left === null ? 0 : 1) + (current.right === null ? 0 : 1)            if(current === this._root) {                switch(childCount){                    case 0:                        this._root = null;                        break;                    case 1:                        this._root = current.right === null ? current.left : current.right                        break;                    case 2:                        //æ–°çš„æ ¹èŠ‚ç‚¹æ˜¯æºæ ¹èŠ‚ç‚¹çš„åšå­èŠ‚ç‚¹                        //å·¦å­æ ‘çš„æœ€å³èŠ‚ç‚¹ ç›´æ¥å‰é©±                        replacement = this._root.left                        while (replacement.right !== null) {                            replacementParent = replacement                            replacement = replacement.right                        }                        if(replacementParent !== null) {                            replacementParent.right = replacement.left                            replacement.right = this._root.right                            replacement.left = this._root.left                        }                        this._root = replacement                }            } else {                switch(childCount){                    case 0:                        if(current.value > parent.value) {                            parent.left = null;                        } else {                            parent.right = null                        }                        break;                    case 1:                        if(current.value > parent.value) {                        parent.left = current.left ? current.left.value : current.right.value                    } else {                        parent.right = current.left ? current.left.value : current.right.value                    }                    case 2:                      //TODO                        replacement = current.left                        replacementParent = current                        while (replacement.right !== null) {                            replacementParent = replacement                            replacement = replacement.right                        }                        replacementParent = replacement.left                         replacementParent.right = current.right                        replacementParent.left = current.left                        if (parent.value > replacement.value) {                            parent.left = replacement                        } else {                            parent.right = replacement                        }                }            }        }    },    size: function () {        var length = 0;        this.traverse(function(node){            length++;        })        return length    },    traverse: function (process) {        // è¾…åŠ©å‡½æ•°éå†èŠ‚ç‚¹        function inOrder(node) {            if(node.left !== null) {                inOrder(node.left)            }            // call ä½¿ç”¨æŒ‡å®šçš„this å’Œå•ç‹¬ç»™å‡ºçš„ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå†æ¬¡æ­¤å¤„è°ƒç”¨process            process.call(this, node);            if (node.right !== null) {                inOrder(node.right)            }        }        inOrder(this._root)    },    toArray: function () {        var result = [];        this.traverse(function(node){            result.push(node.value)        })        return result    },    toString: function () {        return this.toArray().toString();    },}]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>algorithm/Array/index</title>
    <link href="/2020/07/06/algorithm/Array/index/"/>
    <url>/2020/07/06/algorithm/Array/index/</url>
    
    <content type="html"><![CDATA[/** æ•°ç»„çš„æ‰å¹³åŒ–* å·²çŸ¥å¦‚ä¸‹æ•°ç»„ï¼švar arr = [ [1, 2, 2], [3, 4, 5, 5], [6, 7, 8, 9, [11, 12, [12, 13, [14] ] ] ], 10];* ç¼–å†™ä¸€ä¸ªç¨‹åºå°†æ•°ç»„æ‰å¹³åŒ–å»å¹¶é™¤å…¶ä¸­é‡å¤éƒ¨åˆ†æ•°æ®ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå‡åºä¸”ä¸é‡å¤çš„æ•°ç»„* */Array.prototype.flat = function (arr, result) {  result  arr.forEach((item) => {    Array.isArray(item) ? arguments.callee(item) : item.push(newArr)  })  return newArr}]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>algorithm/Function/compose</title>
    <link href="/2020/07/06/algorithm/Function/compose/"/>
    <url>/2020/07/06/algorithm/Function/compose/</url>
    
    <content type="html"><![CDATA[/** * å‡½æ•°çš„ç»„åˆ */let toUpperCase = function (str) {    return str.toUpperCase(str);}let hello = function(name) {    return `hi, {name}!`;}let sayHello = function() {    return hello(toUpperCase('Tom'));}/** * æˆ‘ä»¬å¯ä»¥çœ‹åˆ° hello å‡½æ•°ä½¿ç”¨äº† toUpperCaseçš„è¿”å›å€¼ ç±»ä¼¼äº * sayHello = f(g(x)), è¿™æ—¶æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªcompose å‡½æ•° å°†è¿™ä¸ªå‡½æ•°åšä¸ºå‚æ•°*/function _compose(f, g) {    return function (x) {        return f(g(x));    }}/** * å¦‚æœ compose(f, g, h, i)? * éš¾é“è¦å†™æˆ compose(f, compose(g, compose(h, i))? */function compose() {    let length = arguments.length;    let args = arguments;    return function () {        let start = length -1;        let result = args.apply(this, arguments);        while (start--) args[start].apply(this, result)        return result;    }}]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>algorithm/Function/curry</title>
    <link href="/2020/07/06/algorithm/Function/curry/"/>
    <url>/2020/07/06/algorithm/Function/curry/</url>
    
    <content type="html"><![CDATA[/** * @name curry * @version 1.0 * @description å‡½æ•°çš„æŸ¯é‡ŒåŒ–  * @param fn * @param num * @example curry(add, 1, 2)*/function _curry(fn) {    const args = [].slice.apply(arguments, 1);    return function () {        return fn.apply(this, args.concat(...arguments))    }}/** * @name curry * @version 1.1 * @param fn * @description currying is a technique of translating an evaluation of a function  * that takes multiple arguments (or tuple arguments) into evaluating a sequence  * functions, each with a single function; * @param length fnçš„å‚æ•°ä¸ªæ•° * @example curry(add(1, 2)) */ function curry(fn, length) {    // åˆ¤æ–­è¦curryçš„å‡½æ•°çš„å‚æ•°ä¸ªæ•°      length = length || fn.length;    let slice = Array.prototype.slice;    return function () {        if(arguments.length < length) {            const args = [fn].concat(slice.apply(this, arguments))            return curry(_curry.apply(this, args), length - arguments.length);        } else {            return fn.apply(this, arguments)        }            } }]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
